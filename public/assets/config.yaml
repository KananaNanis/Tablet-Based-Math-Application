# this config tree assumes order, even for yaml hashes!
params:
  # modify:
  #   expr_1: {left: 5, arg_spacing: 20, res_spacing: 30}
identity_function:
  params:
    generate: { arg_1_name: [uniform, .1, 1.7] }
    # generate: { arg_1_name: [fixed, .2] }
    create:
      bar_1: { name: [arg_1_name] }
      bar_3: { name: [arg_1_name] }
    modify:
      bar_1:
        position: [100, 0]
      bar_3:
        position: [460, 0]
    event_handling:
      arg_1: bar_1
      correctness: near_height
      top_right_text: average_error
    misc:
      config_iteration: 5
      num_stars: 2
      remove_on_exit: [err_box]
      blank_between_exercises: 500
      curr_op: identity
  as_option:
    params:
      generate:
        option_skip_permute: true  # before seed!
        option_value_delta: 0.2
        option_value_seed: arg_1_name
        restriction_1: option > 0.05
        restriction_2: option < 1.7
      modify:
        bar_3:
          position: [10, 0]
          misc:
            is_option: true
            option_width: 95
            option_offset: 280
      event_handling:
        arg_1: bar_1
        result: bar_3
    bars:
      params:
      level_1:
        params:
          misc:
            jmp: [identity_function, as_drag, bars, level_1]
    doors:
      level_1:
        params:
          remap_ids:
            bar_1: door_1
            bar_3: door_3
          misc:
            jmp: [identity_function, as_drag, doors, level_1]
  as_drag:
    params:
      create:
        bar_3: { name: [1.8] }
      modify:
        bar_3:
          anim_info: { blink: [.5, 1] }
      event_handling:
        move: stretch_bar
        comparison_source: bar_1
        target: bar_3
        correctness: full_height
        touch_reveals_button: submit
    bars:
      level_1:
        params:
          misc:
            jmp: [identity_function, as_option, doors, level_1]
    doors:
      level_1:
        params:
          remap_ids:
            bar_1: door_1
            bar_3: door_3
          modify:
            bar_3:
              style: {opacity: 1}
              misc:
                handle_opacity: 0
                mutable: true
          event_handling:
            result: door_3
            move: move_handle
intro_halves:
  params:
    generate:
      # bar_1_name: [fixed, .5]
      bar_1_name: [uniform, .2, 1.1]
    create:
      door_3: [.5]
      bar_1: { name: bar_1_name }
    modify:
      door_3:
        position: [35vw, 0]
        style:
        misc:
          frame_thickness: 0
          handle_thickness: 1
          handle_width: 300
          handle_opacity: 0
          handle_color: orange
      bar_1:
        position: [40vw, 0]
        anim_info: { blink: [.5, 1] }
        style:
          borderRadius: 25
          width: 250
    event_handling:
      move: move_handle
      comparison_source: bar_1
      target: door_3
      correctness: half_height
      touch_reveals_button: submit
    misc:
      config_iteration: 4
      # config_iteration: 1
      num_stars: 3
      remove_on_exit: [button_submit]
  level_1:
    params:
      misc:
        # jmp: jmp_label_1
        jmp: [add_or_half, as_option, result_option, half, bars, level_1]
add_or_half:
  params:
    generate: { arg_1_name: [uniform, .1, 1.6],
                # arg_1_name: [fixed, .2],
                result_name: [uniform, .2, 1.7],
                # result_name: [fixed, .5],
                arg_2_name: result_name - arg_1_name,
                restriction_1: arg_2_name > .1,
                restriction_2: arg_2_name < 1.6 }
    create:
      big_paren: true
      big_op: +
      # bar_1: [.2]
      # bar_2: [.3]
      # bar_3: [.5]
      bar_1: { name: [arg_1_name] }
      bar_2: { name: [arg_2_name] }
      bar_3: { name: [result_name] }
    modify:
      big_paren:
        position: [20, 0]
        style: { width: 300 }
      big_op:
        position: [80, 0]
        style: {opacity: 1}
    event_handling:
      correctness: near_height
      top_right_text: average_error
      arg_1: bar_1
      arg_2: bar_2
      result: bar_3
    misc:
      config_iteration: 7
      num_stars: 3
      remove_on_exit: [err_box]
      blank_between_exercises: 500
      event_handling: { arg_2: bar_2 }
  as_option:
    params:
      generate:
        # option_value_delta: [[.5], [.3], [.2], [.1]]
        option_skip_permute: true  # before seed!
        option_value_delta: 0.3
        restriction_3: option > 0
        restriction_4: option < 1.7
      modify:
        big_op:
          position: [80, 0]
        big_paren:
          style: { width: 570 }
        bar_1:
          position: [10, 0]
        bar_3:
          position: [580, 0]
    result_option:
      params:
        generate:
          option_value_seed: result_name
        modify:
          big_paren:
            style: { width: 270 }
          bar_2:
            position: [195, 0]
          bar_3:
            position: [10, 0]
            misc:
              is_option: true
              option_width: 95
              option_offset: 280
      stack:
        params:
          modify:
            bar_3:
              style: {opacity: 0}
        bars:
          params:
          level_1:
            params:
              event_handling:
                stack_arg_2: true
          level_2:
            params:
              generate:  # want to compute position for bar_2
                bar_1_w: .25 * default_bar_width
                bar_1_x: 10 + bar_1_w
                bar_1_y: arg_1_name * scale_factor
              modify:
                bar_2:
                  anim_info:
                    left: [195, bar_1_x]
                    bottom: [0, bar_1_y]
                    delay: 500
                    duration: 500
                    on_end: [reveal_bar_3]
          level_3:
            params:
              generate:  # want to compute position for bar_2
                bar_1_w: .75 * default_bar_width
                bar_1_x: 10 + bar_1_w
                bar_1_y: arg_1_name * scale_factor
              modify:
                bar_2:
                  anim_info:
                    # left: [195, bar_1_x]
                    bottom: [0, bar_1_y]
                    delay: 500
                    duration: 500
                    on_end: [return_bar_2]
      bars:
        params:
        level_1:
          params:
            misc:
              jmp: [add_or_half, as_drag, result_option, bars, level_1]
      doors:
        params:
          remap_ids:
            bar_1: door_1
            bar_2: door_2
            bar_3: door_3
        level_1:
          params:
            misc:
              jmp: [add_or_half, as_drag, result_option, doors, level_1]
      half:
        params:
          generate: { result_name: 0.5 * arg_1_name }
          create:
            big_op: '*'
            bar_2: remove
            five_frame_2: { name: .5 }
          modify:
            five_frame_2:
              position: [130, 0]
              style: { color: grey }
              misc:
                just_text: true
                extra_scale: .4
        bars:
          params:
          level_1:
            params:
              misc:
                jmp: [add_or_half, as_drag, result_option, half, bars, level_1]
        doors:
          params:
            remap_ids:
              bar_1: door_1
              bar_3: door_3
          level_1:
            params:
              misc:
                jmp: [add_or_half, as_drag, result_option, half, doors, level_1]
    arg_1_option:
      params:
        generate:
          option_value_delta: -0.3
          option_value_seed: arg_1_name
        modify:
          big_op:
            position: [380, 0]
          bar_1:
            position: [10, 0]
            misc:
              is_option: true
              option_width: 95
              option_offset: 0
          bar_2:
            position: [495, 0]
      bars:
        params:
        level_1:
          params:
            misc:
              jmp: [add_or_half, as_drag, arg_1_option, bars, level_1]
      doors:
        params:
          remap_ids:
            bar_1: door_1
            bar_2: door_2
            bar_3: door_3
        level_1:
          params:
            misc:
              jmp: [add_or_half, as_drag, arg_1_option, doors, level_1]
      half:
        params:
          generate: { result_name: 0.5 * arg_1_name }
          create:
            big_op: '*'
            bar_2: remove
            five_frame_2: { name: .5 }
          modify:
            five_frame_2:
              position: [430, 0]
              style: { color: grey }
              misc:
                just_text: true
                extra_scale: .4
        bars:
          params:
          level_1:
            params:
              misc:
                jmp: [add_or_half, as_drag, arg_1_option, half, bars, level_1]
        doors:
          params:
            remap_ids:
              bar_1: door_1
              bar_3: door_3
          level_1:
            params:
              misc:
                jmp: [add_or_half, as_drag, arg_1_option, half, doors, level_1]
    arg_2_option:
      params:
        generate:
          option_value_seed: arg_2_name
        modify:
          bar_2:
            position: [10, 0]
            misc:
              is_option: true
              option_width: 95
              option_offset: 190
      bars:
        params:
        level_1:
          params:
            misc:
              jmp: [add_or_half, as_drag, arg_2_option, bars, level_1]
      doors:
        params:
          remap_ids:
            bar_1: door_1
            bar_2: door_2
            bar_3: door_3
        level_1:
          params:
            misc:
              jmp: [add_or_half, as_drag, arg_2_option, doors, level_1]
  as_drag:
    params:
      create:
        err_box:
      modify:
        bar_1:
          position: [10, 0]
        bar_2:
          position: [220, 0]
        bar_3:
          position: [320, 0]
      event_handling:
        arg_1: bar_1
        arg_2: bar_2
        result: bar_3
        touch_reveals_button: submit
        star_policy: extraLoose
    result_option:
      params:
        modify:
          bar_3:
            style: {opacity: 1}
            anim_info: { blink: [0, 1] }
            misc:
              mutable: true
        event_handling:
          move: stretch_bar
          target: bar_3
      bars:
        params:
          create:
            # bar_2: { name: [0] }
            bar_3: { name: [1.8] }
        level_1:
          params:
            misc:
              jmp: [add_or_half, as_option, result_option, doors, level_1]
      doors:
        params:
          remap_ids:
            bar_1: door_1
            bar_2: door_2
            bar_3: door_3
          create:
            # bar_2: { name: [0] }
          modify:
            bar_3:
              misc:
                handle_opacity: 0
          event_handling:
            move: move_handle
        level_1:
          params:
            misc:
              jmp: [add_or_half, as_option, arg_2_option, bars, level_1]
          # params:
            # generate: { arg_2_name: [fixed, .5],
            #   result_name: arg_1_name + arg_2_name }
      half:
        params:
          generate: { result_name: 0.5 * arg_1_name }
          create:
            big_op: '*'
            bar_2: remove
            five_frame_2: { name: .5 }
          modify:
            five_frame_2:
              position: [150, 0]
              style: { color: grey }
              misc:
                just_text: true
                extra_scale: .4
          event_handling:
            arg_2: five_frame_2
        bars:
          params:
          level_1:
            params:
              create:
                bar_3: { name: [1.8] }
              misc:
                jmp: [add_or_half, as_option, result_option, half, doors, level_1]
        doors:
          params:
            remap_ids:
              bar_1: door_1
              bar_3: door_3
            modify:
              bar_3:
                misc:
                  handle_opacity: 0
            event_handling:
              move: move_handle
          level_1:
            params:
              misc:
                jmp: [add_or_half, as_option, arg_1_option, half, bars, level_1]
    arg_1_option:
      params:
        modify:
          bar_1:
            style: {opacity: 1}
            anim_info: { blink: [0, 1] }
            misc:
              mutable: true
        event_handling:
          move: stretch_bar
          target: bar_1
      bars:
        params:
          create:
            bar_1: { name: [1.8] }
        level_1:
          params:
            misc:
              jmp: [add_or_half, as_option, arg_1_option, doors, level_1]
      doors:
        params:
          remap_ids:
            bar_1: door_1
            bar_2: door_2
            bar_3: door_3
          create:
            # bar_2: { name: [0] }
          modify:
            bar_1:
              misc:
                handle_opacity: 0
          event_handling:
            move: move_handle
        level_1:
          params: {misc: {jmp: all_done}}
      half:
        params:
          generate: { result_name: 0.5 * arg_1_name }
          create:
            big_op: '*'
            bar_2: remove
            five_frame_2: { name: .5 }
          modify:
            five_frame_2:
              position: [150, 0]
              style: { color: grey }
              misc:
                just_text: true
                extra_scale: .4
          event_handling:
            arg_2: five_frame_2
        bars:
          params:
          level_1:
            params:
              create:
                bar_1: { name: [1.8] }
              misc:
                jmp: [add_or_half, as_option, arg_1_option, half, doors, level_1]
        doors:
          params:
            remap_ids:
              bar_1: door_1
              bar_3: door_3
            modify:
              bar_1:
                misc:
                  handle_opacity: 0
            event_handling:
              move: move_handle
          level_1:
            params:
              misc:
                jmp: [add_or_half, as_option, result_option, bars, level_1]
    arg_2_option:
      params:
        modify:
          bar_2:
            style: {opacity: 1}
            anim_info: { blink: [0, 1] }
            misc:
              mutable: true
        event_handling:
          move: stretch_bar
          target: bar_2
      bars:
        params:
          create:
            bar_2: { name: [1.8] }
        level_1:
          params:
            misc:
              jmp: [add_or_half, as_option, arg_2_option, doors, level_1]
      doors:
        params:
          remap_ids:
            bar_1: door_1
            bar_2: door_2
            bar_3: door_3
          create:
            # bar_2: { name: [0] }
          modify:
            bar_2:
              misc:
                handle_opacity: 0
          event_handling:
            move: move_handle
        level_1:
          params:
            misc:
              jmp: [add_or_half, as_option, arg_1_option, bars, level_1]
add_height:
  params:
    generate: { arg_1_name: [uniform, .1, 1.6],
                # arg_1_name: [fixed, .2],
                result_name: [uniform, .2, 1.7],
                # result_name: [fixed, .5],
                arg_2_name: result_name - arg_1_name,
                restriction_1: arg_2_name > .1,
                restriction_2: arg_2_name < 1.6 }
    create:
      big_paren: true
      big_op: +
    modify:
      big_paren:
        position: [20, 0]
        style: { width: 300 }
      big_op:
        position: [80, 0]
        style: {opacity: 1}
    event_handling:
      correctness: near_height
      top_right_text: average_error
    misc:
      config_iteration: 2
      num_stars: 3
      remove_on_exit: [err_box]
      blank_between_exercises: 500
  bar_target:
    params:
      # generate: { restriction_2: arg_1_name < arg_2_name }
      create:
        # bar_1: [.2]
        # bar_2: [.3]
        # bar_3: [.5]
        bar_1: { name: [arg_1_name] }
        bar_2: { name: [arg_2_name] }
        bar_3: { name: [result_name] }
      modify:
        big_paren:
          style: { width: 570 }
        big_op:
          position: [380, 0]
        bar_1:
          position: [10, 0]
        bar_2:
          position: [495, 0]
        bar_3:
          position: [580, 0]
      event_handling: { arg_2: bar_2 }
    arg1_option:
      params:
        generate:
          # option_value_delta: [[.5], [.3], [.2], [.1]]
          option_skip_permute: true  # before seed!
          option_value_delta: -0.3
          option_value_seed: arg_1_name
          restriction_3: option > 0
          restriction_4: option < 1.7
        modify:
          bar_1:
            position: [10, 0]
            misc:
              is_option: true
              option_width: 95
              option_offset: 0
        event_handling:
          arg_1: bar_1
          arg_2: bar_2
      level_1:
    actual_addition:
      params:
        create:
          err_box:
        modify:
          bar_3:
            style: {opacity: 1}
            misc:
              mutable: true
        event_handling:
          target: bar_3
          touch_reveals_button: submit
          star_policy: loose
      level_1:
        params:
      level_2:
  door_target:
    params:
      create:
        # door_1: { name: [arg_1_name] }
        # door_3: { name: [result_name] }
        door_1: [.2]
        door_3: [.5]
        # door_2: { name: [arg_2_name] }
        door_2: [.3]
      modify:
        door_1:
          position: [10, 0]
        door_3:
          position: [320, 0]
        door_2:
          position: [220, 0]
      event_handling:
        arg_1: door_1
        arg_2: door_2
        result: door_3
        move: move_handle
    actual_addition:
      params:
        create:
          err_box:
        modify:
          door_3:
            style: {opacity: 1}
            anim_info: { blink: [0, 1] }
            misc:
              handle_opacity: 0
              mutable: true
        event_handling:
          target: door_3
          touch_reveals_button: submit
          star_policy: loose
      level_1:
        params:
          generate: { arg_2_name: [fixed, .5],
            result_name: arg_1_name + arg_2_name }
      level_2:
pure_five_frame:
  params:
    generate:
      prompt_value: [pick_from_range, 1, 5.5, 1]
      option_value_delta: [[1], [2], [3], [4], [5]]
      option_value_seed: prompt_value
      restriction_3: option > 0
      restriction_4: option < 6
    create:
      five_frame_1: { name: prompt_value }
      five_frame_2: { name: 1 }
      door_9: [10.0]  # as a reference
    modify:
      five_frame_1:
        position: [20, 0]
        # this only works once, since it is looking for changes!
        # anim_info: { opacity: [1, 0], duration: 1000 }
        misc:
          extra_scale: .245
      five_frame_2:
        position: [0, 0]
        misc:
          is_option: true
          just_text: true
          extra_scale: .5
      door_9:
        position: [10, 0]
        misc: {tickmarks: [.5, 1.5]}
    event_handling:
      correctness: identical
      target: five_frame_2
      arg_1: five_frame_1
      comparison_source: five_frame_1
    misc:
      config_iteration: 5
      num_stars: 3
  level_1:
  disappearing:
    params:
      create:
        button_start:
      modify:
        five_frame_1:
          anim_info: null
          style: { opacity: 0 }
        five_frame_2:
          style: { opacity: 0 }
      misc:
        freeze_display: true
    level_2:
      params:
        delay:
          modify:
            five_frame_1:
              style: { opacity: 1 }
              anim_info:
                opacity: [1, 0]
                delay: 1000
                duration: 500
            five_frame_2:
              appear_after: 1500
    level_3:
      params:
        delay:
          modify:
            five_frame_1:
              style: { opacity: 1 }
              anim_info:
                opacity: [1, 0]
                delay: 250
                duration: 250
            five_frame_2:
              appear_after: 500
    level_4:
      params:
        misc:
          jmp: ['intro_names', 'copy_tower', 'level_1']
        delay:
          modify:
            five_frame_1:
              style: { opacity: 1 }
              anim_info: { opacity: [1, 0], delay: 0, duration: 250 }
            five_frame_2:
              appear_after: 250
intro_diagrams:
  params:
    create:
      keypad_kind: 'buildTower'
      tower_2: []
      button_submit:
    event_handling: { target: tower_2 }
    modify:
      tower_2: { position: [65vw, 0] }
    misc:
      config_iteration: 4
      # config_iteration: 1
      num_stars: 3
  copy_tower:
    params:
      generate: { tower_1_name: [pick_from_range, .1, 1.8, .1] }
      # generate: { tower_1_name: [fixed, .8] }
      create:
        tower_1: { name: tower_1_name }
        button_submit: remove
        keypad_kind: remove  # new approach does not use keypad
      modify:
        tower_1:
          position: [5, 0]
          # width: 60vw
          # overflow: 'hidden'
          misc:
            hide_tower_name: true
            # top_just_outline: true
        tower_2:
          misc:
            hide_tower_name: true
      event_handling:
        comparison_source: tower_1
        target: tower_2
        correctness: identical
    level_1:
      params:
        generate:
          option_value_delta: 0.2
          option_value_seed: tower_1_name
          restriction_3: option > 0
          restriction_4: option < 1.9
        create:
          tower_2: [1.1]
        modify:
          tower_2:
            position: [0, 0]
            misc:
              is_option: true
        event_handling:
          arg_1: tower_1
    level_2:
      params:
        event_handling:
          touch_reveals_button: [submit, delete]
          create_tower_by_height: true
        misc:
          remove_on_exit: [button_submit, button_delete]
    level_3:
      params:
        generate:
          option_value_delta: 0.2
          option_value_seed: tower_1_name
          restriction_3: option > 0
          restriction_4: option < 1.9
        modify:
          tower_1:
            misc:
              as_diagram: true
          tower_2:
            position: [0, 0]
            misc:
              is_option: true
              as_diagram: true
        event_handling:
          arg_1: tower_1
    level_4:
      params:
        modify:
          tower_1:
            misc:
              as_diagram: true
          tower_2:
            misc:
              as_diagram: true
        event_handling:
          touch_reveals_button: [submit, delete]
          create_tower_by_height: true
        misc:
          remove_on_exit: [button_submit, button_delete]
    level_5:
      params:
        generate:
          option_value_delta: 0.2
          option_value_seed: tower_1_name
          restriction_3: option > 0
          restriction_4: option < 1.9
        modify:
          tower_2:
            position: [0, 0]
        event_handling:
          arg_1: tower_1
      level_5a:
        params:
          modify:
            tower_1:
              misc:
                as_diagram: true
            tower_2:
              misc:
                is_option: true
      level_5b:
        params:
          modify:
            tower_2:
              misc:
                is_option: true
                as_diagram: true
intro_names:
  params:
    create:
      keypad_kind: 'buildTower'
      tower_2: []
      button_submit:
    event_handling: { target: tower_2 }
    modify:
      tower_2:
        position: [65vw, 0]
        misc:
          tower_name_style: { left: 5 }
    misc:
      config_iteration: 4
      # config_iteration: 1
      num_stars: 3
  copy_tower:
    params:
      generate: { tower_1_name: [pick_from_range, .1, 1.8, .1] }
      # generate: { tower_1_name: [fixed, .8] }
      create:
        tower_1: { name: tower_1_name }
        button_submit: remove
        keypad_kind: remove  # new approach does not use keypad
      modify:
        tower_1:
          position: [5, 0]
          tower_style: {opacity: 0}
          # width: 60vw
          # overflow: 'hidden'
          # misc:
            # hide_tower_name: true
            # top_just_outline: true
        tower_2:
          tower_style: {opacity: 0}
          # misc:
            # hide_tower_name: true
      event_handling:
        comparison_source: tower_1
        target: tower_2
        correctness: identical
    level_1:
      params:
        generate:
          option_value_delta: 0.2
          option_value_seed: tower_1_name
          restriction_3: option > 0
          restriction_4: option < 1.9
        modify:
          tower_2:
            position: [0, 0]
            misc:
              is_option: true
        event_handling:
          arg_1: tower_1
    level_2:
      params:
        # generate: { tower_1_name: [fixed, 1.6] }
        create:
          keypad_kind: 'buildTower'
        event_handling:
          touch_reveals_button: [submit, delete]
        misc:
          remove_on_exit: [button_submit, button_delete]
    level_3:
      params:
        generate:
          option_value_delta: 0.2
          option_value_seed: tower_1_name
          restriction_3: option > 0
          restriction_4: option < 1.9
        modify:
          tower_2:
            position: [0, 0]
            tower_style: {opacity: null}
            misc:
              is_option: true
              hide_tower_name: true
              # as_diagram: true
        event_handling:
          arg_1: tower_1
      level_3a:
      level_3b:
        params:
          modify:
            tower_1:
              tower_style: {opacity: null}
              misc:
                hide_tower_name: true
            tower_2:
              tower_style: {opacity: 0}
              misc:
                hide_tower_name: null
    level_4:
      params:
        create:
          keypad_kind: 'buildTower'
        modify:
          tower_1:
            tower_style: {opacity: null}
            misc:
              hide_tower_name: true
          tower_2:
            position: [right 100, 0]
        event_handling:
          touch_reveals_button: [submit, delete]
        misc:
          remove_on_exit: [button_submit, button_delete]
    level_5:
      params:
        modify:
          tower_2:
            tower_style: {opacity: null}
            misc:
              hide_tower_name: true
        event_handling:
          touch_reveals_button: [submit, delete]
          create_tower_by_height: true
        misc:
          remove_on_exit: [button_submit, button_delete]
    level_6:
      params:
        generate:
          option_value_delta: 0.2
          option_value_seed: tower_1_name
          restriction_3: option > 0
          restriction_4: option < 1.9
        modify:
          tower_2:
            position: [0, 0]
            tower_style: {opacity: null}
            misc:
              is_option: true
              hide_tower_name: true
              as_diagram: true
        event_handling:
          arg_1: tower_1
      level_6a:
      level_6b:
        params:
          modify:
            tower_1:
              tower_style: {opacity: null}
              misc:
                hide_tower_name: true
                as_diagram: true
            tower_2:
              tower_style: {opacity: 0}
              misc:
                hide_tower_name: null
    level_7:
      params:
        create:
          keypad_kind: 'buildTower'
        modify:
          tower_1:
            tower_style: {opacity: null}
            misc:
              hide_tower_name: true
              as_diagram: true
        event_handling:
          touch_reveals_button: [submit, delete]
        misc:
          remove_on_exit: [button_submit, button_delete]
    level_8:
      params:
        modify:
          tower_2:
            tower_style: {opacity: null}
            misc:
              hide_tower_name: true
              as_diagram: true
        event_handling:
          touch_reveals_button: [submit, delete]
          create_tower_by_height: true
        misc:
          remove_on_exit: [button_submit, button_delete]
one_through_five:
  params:
    generate:
      prompt_value: [pick_from_range, .1, .55, .1]
      option_value_delta: [[.1], [.2], [.3], [.4], [.5]]
      option_value_seed: prompt_value
      restriction_3: option > 0
      restriction_4: option < 1.9
    create:
      tower_2: []
    modify:
      tower_2:
        position: [0, 0]
        tower_style: { opacity: 0 }
        misc:
          is_option: true
          tower_name_style: { left: 5 }
    event_handling:
      target: tower_2
      correctness: identical
    misc:
      config_iteration: 7
      # config_iteration: 2
      # config_iteration: 1
      num_stars: 3
  pegs:
    params:
      generate:
        peg_type: [pick_from_list, ['a', 'b', 'c']]
        peg_name: as_peg_name peg_type prompt_value
        option_value_delta: [[.1], [.2], [.3], [.4], [.5]]
        restriction_4: option < .6
        prompt_value_10: 10 * prompt_value
      create:
        tile_1: { name: peg_name }
        door_9: [10.0]  # as a reference
      modify:
        tile_1:
          position: [20, 0]
          style: { borderTopWidth: 0 }
        door_9:
          position: [10, 0]
          misc: {tickmarks: [.5, 1.5]}
      event_handling:
        arg_1: tile_1
        comparison_source: tile_1
    pegs_with_five_frames:
      params:
        create:
          five_frame_3: { name: 0 }
        modify:
          five_frame_3:
            position: [20, 0]
            style: {opacity: 0.2}
            misc:
              extra_scale: .245
        misc:
          config_iteration: 5
      level_1:
      disappearing:
        params:
          create:
            button_start:
          modify:
            five_frame_3:
              style: { opacity: 0 }
            tile_1:
              style: { opacity: 0 }
            tower_2:
              style: { opacity: 0 }
          misc:
            freeze_display: true
        level_2:
          params:
            delay:
              modify:
                tile_1:
                  style: { opacity: 1 }
                five_frame_3:
                  style: { opacity: 0.1 }
                  anim_info:
                    opacity: [0.1, 0]
                    delay: 1000
                    duration: 1500
                tower_2:
                  style: { opacity: 1 }
        level_3:
          params:
            delay:
              modify:
                tile_1:
                  style: { opacity: 1 }
                five_frame_3:
                  style: { opacity: 0.1 }
                  anim_info:
                    opacity: [0.1, 0]
                    delay: 1000
                    duration: 500
                tower_2:
                  style: { opacity: 1 }
        level_4:
          params:
            delay:
              modify:
                tile_1:
                  style: { opacity: 1 }
                five_frame_3:
                  style: { opacity: 0.1 }
                  anim_info:
                    opacity: [0.1, 0]
                    delay: 500
                    duration: 250
                tower_2:
                  style: { opacity: 1 }
        level_5:
          params:
            delay:
              modify:
                tile_1:
                  style: { opacity: 1 }
                five_frame_3:
                  style: { opacity: 0.1 }
                  anim_info:
                    opacity: [0.1, 0]
                    duration: 250
                tower_2:
                  style: { opacity: 1 }
    level_2:
    disappearing:
      params:
        create:
          button_start:
        modify:
          tile_1:
            style: { opacity: 0 }
          tower_2:
            style: { opacity: 0 }
        misc:
          freeze_display: true
      level_3:
        params:
          delay:
            modify:
              tile_1:
                style: { opacity: 1 }
                anim_info:
                  opacity: [1, 0]
                  delay: 1000
                  duration: 500
              tower_2:
                appear_after: 1500
      level_4:
        params:
          delay:
            modify:
              tile_1:
                style: { opacity: 1 }
                anim_info:
                  opacity: [1, 0]
                  delay: 250
                  duration: 250
              tower_2:
                appear_after: 500
      level_5:
        params:
          delay:
            modify:
              tile_1:
                style: { opacity: 1 }
                anim_info:
                  opacity: [1, 0]
                  delay: 100
                  duration: 150
              tower_2:
                appear_after: 250
  doors:
    params:
      generate:
        restriction_4: option < .6
      create:
        door_1: { name: [prompt_value] }
      modify:
        door_1:
          position: [10, 0]
          misc: {tickmarks: [.5, 1.5]}
      event_handling:
        arg_1: door_1
        comparison_source: door_1
    level_1:
      params:
        generate:
          peg_type: [pick_from_list, ['a', 'b', 'c']]
          peg_name: as_peg_name peg_type prompt_value
        create:
          tile_3: { name: peg_name }
        modify:
          tile_3:
            position: [20, 0]
            style: {opacity: 0.3}
        misc:
          config_iteration: 5
    level_2:
    disappearing:
      params:
        create:
          button_start:
        modify:
          door_1:
            style: { opacity: 0 }
          tower_2:
            style: { opacity: 0 }
        misc:
          freeze_display: true
      level_3:
        params:
          delay:
            modify:
              door_1:
                style: { opacity: 1 }
                anim_info:
                  opacity: [1, 0]
                  delay: 1000
                  duration: 500
              tower_2:
                appear_after: 1500
      level_4:
        params:
          delay:
            modify:
              door_1:
                style: { opacity: 1 }
                anim_info:
                  opacity: [1, 0]
                  delay: 250
                  duration: 250
              tower_2:
                appear_after: 500
      level_5:
        params:
          delay:
            modify:
              door_1:
                style: { opacity: 1 }
                anim_info:
                  opacity: [1, 0]
                  delay: 100
                  duration: 150
              tower_2:
                appear_after: 250
estimate_names_1_to_5:
  params:
    create:
      keypad_kind: 'buildTower'
      tower_2: []
    event_handling:
      target: tower_2
      touch_reveals_button: [submit, delete]
    modify:
      tower_2:
        position: [65vw, 0]
        tower_style: {opacity: 0}
    misc:
      config_iteration: 7
      # config_iteration: 2
      # config_iteration: 1
      num_stars: 3
      remove_on_exit: [button_submit, button_delete]
  of_doors:
    params:
      # generate: { door_1_name: [pick_from_range, .1, 1.8, .1] }
      create:
        door_1: { name: [door_1_name] }
      modify:
        door_1:
          position: [10, 0]
          misc: {tickmarks: [.5, 1.5]}
      event_handling:
        comparison_source: door_1
        # correctness: identical
        correctness: same_height
    level_1:
      params:
        generate:
          door_1_name: [pick_from_list, [.1, .2, .3, .4, .5]]
          # door_1_name: [fixed, .5]
        modify:
          tower_2:
            tower_style: {opacity: 0}
six_through_nine:
  params:
    generate:
      prompt_value: [pick_from_range, .6, .95, .1]
      option_value_delta: [[.6], [.7], [.8], [.9]]
      option_value_seed: prompt_value
      restriction_3: option > 0
      restriction_4: option < 1.9
    create:
      tower_2: []
    modify:
      tower_2:
        position: [0, 0]
        tower_style: { opacity: 0 }
        misc:
          is_option: true
          tower_name_style: { left: 5 }
    event_handling:
      target: tower_2
      correctness: identical
    misc:
      config_iteration: 7
      # config_iteration: 2
      # config_iteration: 1
      num_stars: 3
  intro:
    params:
      create:
        tower_2: remove
        tower_1: { name: prompt_value }
        door_2: [0]
      modify:
        tower_1:
          position: [10, 0]
          tower_style: { opacity: 0 }
        door_2:
          position: [0, 0]
          misc:
            tickmarks: [.5, 1.5]
            is_option: true
      event_handling:
        arg_1: tower_1
        target: door_2
      misc:
        config_iteration: 5
  doors:
    params:
      create:
        door_1: { name: [prompt_value] }
      modify:
        door_1:
          position: [10, 0]
          misc: {tickmarks: [.5, 1.5]}
      event_handling:
        arg_1: door_1
        comparison_source: door_1
    level_1:
      params:
        create:
          tower_3: { name: prompt_value }
        modify:
          door_1:
            misc:
              handle_opacity: 0
          tower_3:
            position: [20, 0]
            misc:
              hide_tower_name: true
        misc:
          config_iteration: 5
    level_2:
      params:
        create:
          tower_3: { name: prompt_value }
        modify:
          tower_3:
            position: [20, 0]
            style: {opacity: 0.3}
            misc:
              hide_tower_name: true
        misc:
          config_iteration: 5
    level_3:
    disappearing:
      params:
        create:
          button_start:
        modify:
          door_1:
            style: { opacity: 0 }
          tower_2:
            style: { opacity: 0 }
        misc:
          freeze_display: true
      level_4:
        params:
          delay:
            modify:
              door_1:
                style: { opacity: 1 }
                anim_info:
                  opacity: [1, 0]
                  delay: 1000
                  duration: 1500
              tower_2:
                appear_after: 2500
      level_5:
        params:
          delay:
            modify:
              door_1:
                style: { opacity: 1 }
                anim_info:
                  opacity: [1, 0]
                  delay: 1000
                  duration: 500
              tower_2:
                appear_after: 1500
      level_6:
        params:
          delay:
            modify:
              door_1:
                style: { opacity: 1 }
                anim_info:
                  opacity: [1, 0]
                  delay: 250
                  duration: 250
              tower_2:
                appear_after: 500
      level_7:
        params:
          delay:
            modify:
              door_1:
                style: { opacity: 1 }
                anim_info:
                  opacity: [1, 0]
                  delay: 100
                  duration: 150
              tower_2:
                appear_after: 250
estimate_names_6_to_9:
  params:
    create:
      keypad_kind: 'buildTower'
      tower_2: []
    event_handling:
      target: tower_2
      touch_reveals_button: [submit, delete]
    modify:
      tower_2:
        position: [65vw, 0]
        tower_style: {opacity: 0}
    misc:
      config_iteration: 7
      # config_iteration: 2
      # config_iteration: 1
      num_stars: 3
      remove_on_exit: [button_submit, button_delete]
  of_doors:
    params:
      # generate: { door_1_name: [pick_from_range, .1, 1.8, .1] }
      create:
        door_1: { name: [door_1_name] }
      modify:
        door_1:
          position: [10, 0]
          misc: {tickmarks: [.5, 1.5]}
      event_handling:
        comparison_source: door_1
        # correctness: identical
        correctness: same_height
    level_1:
      params:
        generate:
          door_1_name: [pick_from_list, [.6, .7, .8, .9]]
        modify:
          tower_2:
            tower_style: {opacity: 0}
eleven_through_fourteen:
  params:
    generate:
      prompt_value: [pick_from_range, 1.1, 1.45, .1]
      option_value_delta: [[1.1], [1.2], [1.3], [1.4]]
      option_value_seed: prompt_value
      restriction_3: option > 0
      restriction_4: option < 1.9
    create:
      tower_2: []
    modify:
      tower_2:
        position: [0, 0]
        tower_style: { opacity: 0 }
        misc:
          is_option: true
          tower_name_style: { left: 5 }
    event_handling:
      target: tower_2
      correctness: identical
    misc:
      config_iteration: 7
      # config_iteration: 2
      # config_iteration: 1
      num_stars: 3
  intro:
    params:
      create:
        tower_2: remove
        tower_1: { name: prompt_value }
        door_2: [0]
      modify:
        tower_1:
          position: [10, 0]
          tower_style: { opacity: 0 }
        door_2:
          position: [0, 0]
          misc:
            tickmarks: [.5, 1.5]
            is_option: true
      event_handling:
        arg_1: tower_1
        target: door_2
      misc:
        config_iteration: 5
  doors:
    params:
      create:
        door_1: { name: [prompt_value] }
      modify:
        door_1:
          position: [10, 0]
          misc: {tickmarks: [.5, 1.5]}
      event_handling:
        arg_1: door_1
        comparison_source: door_1
    level_1:
      params:
        create:
          tower_3: { name: prompt_value }
        modify:
          door_1:
            misc:
              handle_opacity: 0
          tower_3:
            position: [20, 0]
            misc:
              hide_tower_name: true
        misc:
          config_iteration: 5
    level_2:
      params:
        create:
          tower_3: { name: prompt_value }
        modify:
          tower_3:
            position: [20, 0]
            style: {opacity: 0.3}
            misc:
              hide_tower_name: true
        misc:
          config_iteration: 5
    level_3:
    disappearing:
      params:
        create:
          button_start:
        modify:
          door_1:
            style: { opacity: 0 }
          tower_2:
            style: { opacity: 0 }
        misc:
          freeze_display: true
      level_4:
        params:
          delay:
            modify:
              door_1:
                style: { opacity: 1 }
                anim_info:
                  opacity: [1, 0]
                  delay: 1000
                  duration: 500
              tower_2:
                appear_after: 1500
      level_5:
        params:
          delay:
            modify:
              door_1:
                style: { opacity: 1 }
                anim_info:
                  opacity: [1, 0]
                  delay: 250
                  duration: 250
              tower_2:
                appear_after: 500
      level_6:
        params:
          delay:
            modify:
              door_1:
                style: { opacity: 1 }
                anim_info:
                  opacity: [1, 0]
                  delay: 100
                  duration: 150
              tower_2:
                appear_after: 250
estimate_names_11_to_14:
  params:
    create:
      keypad_kind: 'buildTower'
      tower_2: []
    event_handling:
      target: tower_2
      touch_reveals_button: [submit, delete]
    modify:
      tower_2:
        position: [65vw, 0]
        tower_style: {opacity: 0}
    misc:
      config_iteration: 7
      # config_iteration: 2
      # config_iteration: 1
      num_stars: 3
      remove_on_exit: [button_submit, button_delete]
  of_doors:
    params:
      # generate: { door_1_name: [pick_from_range, .1, 1.8, .1] }
      create:
        door_1: { name: [door_1_name] }
      modify:
        door_1:
          position: [10, 0]
          misc: {tickmarks: [.5, 1.5]}
      event_handling:
        comparison_source: door_1
        # correctness: identical
        correctness: same_height
    level_1:
      params:
        generate:
          door_1_name: [pick_from_list, [1.1, 1.2, 1.3, 1.4]]
        modify:
          tower_2:
            tower_style: {opacity: 0}
        misc:
          jmp: ['estimate_names', 'of_doors', 'level_1']
estimate_tower_height:
  params:
    generate:
      # tower_1_name: [pick_from_range, .1, 1.8, .1]
      # tower_1_name: [pick_from_range, .1, .8, .1]
      tower_1_name:
        exercise0: [fixed, [1]]
        exercise1: [fixed, [.5]]
        exercise2: [fixed, [.1]]
        exercise3: [fixed, [.5, .1]]
    create:
      tower_1: { name: tower_1_name }
      door_3: [0]
    modify:
      tower_1:
        position: [5, 0]
        width: 60vw
        overflow: 'hidden'
        tower_style: { opacity: 0 }
      door_3:
        position: [right 80, 0]
        anim_info: { blink: [0, 1] }
        misc:
          handle_opacity: 0
    event_handling:
      move: move_handle
      comparison_source: tower_1
      target: door_3
      correctness: near_discrete_height
      touch_reveals_button: submit
    misc:
      config_iteration: 4
      # config_iteration: 1
      num_stars: 3
      remove_on_exit: [button_submit]
  level_1:
    params:
      modify:
        tower_1:
          tower_style:
            opacity: 0.1
  level_2:
  level_3:
    params:
      generate:
        tower_1_name:
          exercise0: [fixed, [.5]]
          exercise1: [fixed, [.5, .4]]
          exercise2: [fixed, [1, .1]]
          exercise3: [fixed, [1, .5]]
  level_4:
    skip_node_above:
    params:
      generate:
        tower_1_name:
          exercise0: [fixed, [1]]
          exercise1: [fixed, [.5, .5]]
          exercise2: [fixed, [1, .5]]
          exercise3: [fixed, [.5, .5, .5]]
  level_5:
    skip_node_above:
    params:
      generate:
        tower_1_name:
          exercise0: [fixed, [.5]]
          exercise1: [fixed, [.2, .3]]
          exercise2: [fixed, [.5, .5]]
          exercise3: [fixed, [.5, .2, .3]]
  level_6:
    params:
      generate:
        tower_1_name: [pick_from_range, .1, 1.8, .1]
  level_7:
    params:
      generate:
        tower_1_name: [pick_from_range, .1, 1.8, .1]
estimate_names:
  params:
    create:
      keypad_kind: 'buildTower'
      tower_2: []
    event_handling:
      target: tower_2
      touch_reveals_button: [submit, delete]
    modify:
      tower_2:
        position: [65vw, 0]
        tower_style: {opacity: 0}
    misc:
      config_iteration: 7
      # config_iteration: 1
      num_stars: 3
      remove_on_exit: [button_submit, button_delete]
  of_animals:
    params:
      create:
        tile_1: { name: tile_1_name }
        door_9: [10.0]  # as a reference
      modify:
        tile_1:
          position: [right 40vw, 0]
          # anim_info:   # EXAMPLES OF USING ANIMATION
          #   duration: [2000, 1000, 500, 250]
          #   # duration: 2000
          #   # loop: true
          #   bottom: [0, 200]
          #   opacity: [.5, 1]
        door_9:
          position: [right 39vw, 0]
          misc: {tickmarks: [.5, 1.5]}
      event_handling:
        comparison_source: tile_1
        # correctness: identical
        correctness: same_height
    level_1:
      params:
        generate:
          # tile_1_value: [pick_from_range, .1, 1.8, .1]
          tile_1_value: [pick_from_list, [.1, .9, 1.0, 1.1]]
          tile_1_name: as_animal_name tile_1_value
        modify:
          tower_2:
            tower_style: {opacity: 0.1}
    level_2:
      params:
        generate:
          tile_1_value: [pick_from_list, [.1, .9, 1.0, 1.1]]
          tile_1_name: as_animal_name tile_1_value
    level_3:
      params:
        generate:
          tile_1_value: [pick_from_list, [.2, .5, .8, 1.2]]
          tile_1_name: as_animal_name tile_1_value
    level_4:
      params:
        generate:
          tile_1_value: [pick_from_list, [.3, .4, .6, .7]]
          tile_1_name: as_animal_name tile_1_value
    level_5:
      params:
        generate:
          tile_1_value: [pick_from_list, [1.5, 1.6, 1.7, 1.8]]
          tile_1_name: as_animal_name tile_1_value
        modify:
          tower_2:
            tower_style: {opacity: 0.1}
    level_6:
      params:
        generate:
          tile_1_value: [pick_from_list, [1.5, 1.6, 1.7, 1.8]]
          tile_1_name: as_animal_name tile_1_value
    level_7:
      params:
        generate:
          tile_1_value: [pick_from_list, [1.5, 1.4, 1.3, 1.2]]
          tile_1_name: as_animal_name tile_1_value
  of_doors:
    params:
      # generate: { door_1_name: [pick_from_range, .1, 1.8, .1] }
      create:
        door_1: { name: [door_1_name] }
      modify:
        door_1:
          position: [10, 0]
          misc: {tickmarks: [.5, 1.5]}
      event_handling:
        comparison_source: door_1
        # correctness: identical
        correctness: same_height
    level_1:
      params:
        generate:
          door_1_name: [pick_from_list, [.1, .9, 1.0, 1.1]]
          # door_1_name: [fixed, .5]
        modify:
          tower_2:
            tower_style: {opacity: 0.1}
    level_2:
      params:
        generate:
          door_1_name: [pick_from_list, [.1, .9, 1.0, 1.1]]
    level_3:
      params:
        generate:
          door_1_name: [pick_from_list, [.2, .5, .8, 1.2]]
    level_4:
      params:
        generate:
          door_1_name: [pick_from_list, [.3, .4, .6, .7]]
    level_5:
      params:
        generate:
          door_1_name: [pick_from_list, [1.5, 1.6, 1.7, 1.8]]
        modify:
          tower_2:
            tower_style: {opacity: 0.1}
    level_6:
      params:
        generate:
          door_1_name: [pick_from_list, [1.5, 1.6, 1.7, 1.8]]
    level_7:
      params:
        generate:
          door_1_name: [pick_from_list, [1.5, 1.4, 1.3, 1.2]]
    all_values:
      params:
        generate:
          door_1_name: [pick_from_range, .1, 1.8, .1]
      level_8:
      level_9:
      level_10:
        params:
          misc:
            jmp_no_suffix: [one_through_five, doors, level_1]
            # skip_suffix_for_this_level: true
            suffix_path: [suffix1]
round_2_est_option:
  params:
    generate:
      restriction_3: option > 0
      restriction_4: option < 1.9
    create:
      door_1: { name: [prompt_value] }
      tower_2: []
    modify:
      door_1:
        position: [10, 0]
        misc: {tickmarks: [.5, 1.5]}
      tower_2:
        position: [0, 0]
        tower_style: { opacity: 0 }
        misc:
          is_option: true
          tower_name_style: { left: 5 }
    event_handling:
      target: tower_2
      correctness: identical
      arg_1: door_1
      comparison_source: door_1
    misc:
      config_iteration: 7
      num_stars: 3
  1_to_4:
    params:
      generate:
        prompt_value: [pick_from_range, .1, .45, .1]
        # prompt_value: [fixed, .2]
        option_value_delta: [[.1], [.2], [.3], [.4]]
        option_value_seed: prompt_value
    with_tower:
      params:
        generate:
          int_prompt: 10 * prompt_value
          from_five: 5 - int_prompt
        create:
          tower_1: { name: prompt_value }
          # tower_1: [.4, .1]
        modify:
          tower_1:
            position: [15, 0]
            misc:
              # top_just_outline: from_five
              hide_tower_name: true
      level_1:
      level_2:
        params:
          modify:
            tower_1:
              anim_info:
                opacity: [1, 0]
                duration: 500
    notches:
    no_notches:
      params:
        modify: { door_1: { misc: {tickmarks: null}}}
        misc:
          jmp: ['round_2_est_button', '1_to_4']
  6_to_9:
    params:
      generate:
        prompt_value: [pick_from_range, .6, .95, .1]
        option_value_delta: [[.6], [.7], [.8], [.9]]
        option_value_seed: prompt_value
    with_tower:
      params:
        generate:
          int_prompt: 10 * prompt_value
          from_ten: 10 - int_prompt
        create:
          tower_1: { name: prompt_value }
          # tower_1: [.5, .4, .1]
        modify:
          tower_1:
            position: [15, 0]
            misc:
              # top_just_outline: from_ten
              hide_tower_name: true
      level_1:
      level_2:
        params:
          modify:
            tower_1:
              anim_info:
                opacity: [1, 0]
                duration: 500
    notches:
    no_notches:
      params:
        modify: { door_1: { misc: {tickmarks: null}}}
        misc:
          jmp: ['round_2_est_button', '6_to_9']
  1_to_9:
    params:
      generate:
        prompt_value: [pick_from_range, .1, .95, .1]
        option_value_delta: .1
        option_value_seed: prompt_value
    notches:
    no_notches:
      params:
        modify: { door_1: { misc: {tickmarks: null}}}
        misc:
          jmp: ['round_2_est_button', '1_to_9']
  11_to_14:
    params:
      generate:
        prompt_value: [pick_from_range, 1.1, 1.45, .1]
        option_value_delta: [[1.1], [1.2], [1.3], [1.4]]
        option_value_seed: prompt_value
    notches:
    no_notches:
      params:
        modify: { door_1: { misc: {tickmarks: null}}}
        misc:
          jmp: ['round_2_est_button', '11_to_14']
  15_to_18:
    params:
      generate:
        prompt_value: [pick_from_range, 1.5, 1.85, .1]
        option_value_delta: [[1.5], [1.6], [1.7], [1.8]]
        option_value_seed: prompt_value
    notches:
    no_notches:
      params:
        modify: { door_1: { misc: {tickmarks: null}}}
        misc:
          jmp: ['round_2_est_button', '15_to_18']
  1_to_18:
    params:
      generate:
        prompt_value: [pick_from_range, .1, 1.85, .1]
        option_value_delta: .1
        option_value_seed: prompt_value
    notches:
    no_notches:
      params:
        modify: { door_1: { misc: {tickmarks: null}}}
        misc:
          jmp: ['round_2_est_button', '1_to_18']
round_2_est_button:
  params:
    create:
      keypad_kind: 'buildTower'
      door_1: { name: [door_1_name] }
      tower_2: []
    modify:
      door_1:
        position: [10, 0]
      tower_2:
        position: [65vw, 0]
        tower_style: {opacity: 0}
    event_handling:
      comparison_source: door_1
      correctness: same_height
      target: tower_2
      touch_reveals_button: [submit, delete]
    misc:
      config_iteration: 7
      num_stars: 3
      remove_on_exit: [button_submit, button_delete]
  1_to_4:
    params:
      generate:
        door_1_name: [pick_from_list, [.1, .2, .3, .4]]
      misc:
        jmp: ['round_2_est_option', '6_to_9', 'notches']
  6_to_9:
    params:
      generate:
        door_1_name: [pick_from_range, .6, .95, .1]
      misc:
        jmp: ['round_2_est_option', '1_to_9', 'notches']
  1_to_9:
    params:
      generate:
        door_1_name: [pick_from_range, .1, .95, .1]
      misc:
        jmp: ['round_2_est_option', '11_to_14', 'notches']
  11_to_14:
    params:
      generate:
        door_1_name: [pick_from_range, 1.1, 1.45, .1]
      misc:
        jmp: ['round_2_est_option', '15_to_18', 'notches']
  15_to_18:
    params:
      generate:
        door_1_name: [pick_from_range, 1.5, 1.85, .1]
      misc:
        jmp: ['round_2_est_option', '1_to_18', 'notches']
  1_to_18:
    params:
      generate:
        door_1_name: [pick_from_range, 0.1, 1.85, .1]
      misc:
        jmp: ['all_done']
measure_height:
  params:
    create:
      tower_2: []
    modify:
      tower_2: { position: [65vw, 0] }
    event_handling:
      target: tower_2
      touch_reveals_button: [submit, delete]
    misc:
      remove_on_exit: [button_submit, button_delete]
      config_iteration: 7
      # config_iteration: 1
      num_stars: 3
  animal_height:
    params:
      generate: { tile_1_name: [pick_animal_name] }
      create:
        tile_1: { name: tile_1_name }
      modify:
        tile_1: { position: [right 40vw, 0] }
      event_handling:
        comparison_source: tile_1
        correctness: approx_height
    level_1:
      params:
        event_handling:
          create_tower_by_height: true
    level_2:
      params:
        modify:
          tower_2:
            misc:
              hide_tower_name: true
              as_diagram: true
        event_handling:
          create_tower_by_height: true
    level_3:
      params:
        create:
          keypad_kind: 'buildTower'
        modify:
          tower_2:
            tower_style: { opacity: 0 }
  to_handle:
    params:
      generate: { door_1_name: [pick_from_range, .1, 1.8, .1] }
      create:
        door_1: { name: [door_1_name] }
      modify:
        door_1: { position: [right 60vw, 0] }
      event_handling: { comparison_source: door_1, correctness: same_height }
    level_1:
      params:
        event_handling:
          create_tower_by_height: true
    level_2:
      params:
        modify:
          tower_2:
            misc:
              hide_tower_name: true
              as_diagram: true
        event_handling:
          create_tower_by_height: true
    level_3:
      params:
        create:
          keypad_kind: 'buildTower'
        modify:
          tower_2:
            tower_style: { opacity: 0 }
  copy_tower_subitize:
    params:
      generate: { tower_1_name: [pick_from_range, .1, 1.8, .1] }
      create:
        tower_1: { name: tower_1_name }
        keypad_kind: 'buildTower'
      modify:
        tower_1:
          position: [5, 0]
          width: 60vw
          overflow: 'hidden'
          misc:
            hide_tower_name: true
        tower_2:
          tower_style: { opacity: 0 }
      event_handling: { comparison_source: tower_1, correctness: identical }
    level_1:
    disappearing:
      params:
        create:
          button_start:
        modify:
          tower_1:
            style: { opacity: 0 }
        misc:
          freeze_display: true
      level_2:
        params:
          delay:
            modify:
              tower_1:
                style: { opacity: 1 }
                anim_info:
                  opacity: [1, 0]
                  delay: 1000
                  duration: 500
      level_3:
        params:
          delay:
            modify:
              tower_1:
                style: { opacity: 1 }
                anim_info:
                  opacity: [1, 0]
                  delay: 250
                  duration: 250
      level_4:
        params:
          delay:
            modify:
              tower_1:
                style: { opacity: 1 }
                anim_info:
                  opacity: [1, 0]
                  delay: 100
                  duration: 150
  animal_height_subitize:
    params:
      generate: { tile_1_name: [pick_animal_name] }
      create:
        tile_1: { name: tile_1_name }
        button_submit: remove
        button_start:
        keypad_kind: 'buildTower'
      modify:
        tile_1:
          position: [right 40vw, 0]
          # appear_after: 2000
          style: { borderTopWidth: 0, opacity: 0 }
          # style: { borderTopWidth: 0 }
        tower_2:
          tower_style: { opacity: 0 }
      event_handling:
        comparison_source: tile_1
        correctness: approx_height
        touch_reveals_button: submit
      misc:
        remove_on_exit: [button_submit]
        freeze_display: true
        jmp: [measure_height,  animal_height, level_1]
      delay:
        modify:
          tile_1:
            style: { opacity: 1 }
            anim_info:
              opacity: [1, 0]
              duration: 1000
animal_sum:
  params:
    generate:
      tile_1_name: [pick_animal_name]
      # tile_1_name: [fixed, kitty]
      tile_1_height: height_from_animal tile_1_name
      tile_2_name: [pick_animal_name]
      # tile_2_name: [fixed, puppy]
      tile_2_height: height_from_animal tile_2_name
      door_3_name: tile_1_height + tile_2_height
      restriction_1: door_3_name < 1.1
    create:
      tile_2: { name: tile_2_name }
      tile_1: { name: tile_1_name }
      door_3: { name: [door_3_name] }
    modify:
      tile_1: { position: [right 405, 0] }
      tile_2: { position: [right 200, 0] }
      door_3:
        position: [right 80, 0]
        anim_info: { blink: [0, 1] }
        misc:
          handle_opacity: 0
    event_handling:
      move: move_handle
      arg_1: tile_1
      arg_2: tile_2
      target: door_3
      correctness: near_discrete_height
      touch_reveals_button: submit
    misc:
      config_iteration: 4
      num_stars: 3
      remove_on_exit: [button_submit]
  level_1:
  level_2:
  level_3:
two_doors:  # for a figure
  params:
    create:
      door_1: [.7]
      door_2: [.6]
      button_submit:
    modify:
      door_1:
        position: [250, 0]
        misc:
          extra_scale: 1.3
          handle_color: red
      door_2:
        position: [right 150, 0]
        misc:
          extra_scale: .5
          handle_opacity: 0.25
    misc:
      num_stars: 3
two_animals:
  params:
    generate:
      # some changes have been added for the sake of making a figure
      tile_1_name: [pick_from_list, [unicorn]]
      #tile_1_name: [pick_from_list, [unicorn, dragon, sloth]]
      # tile_1_name: { exercise0: [pick_from_list, [unicorn]] }
      # tile_1_name: [fixed, sloth]
      tile_1_height: height_from_animal tile_1_name
      # tile_2_scale: [uniform, .2, .5]
      tile_2_scale: [fixed, .4]
      tile_2_height: tile_2_scale * tile_1_height
      # landmark_index: [pick_from_range, 0, 7]
      landmark_index: [fixed, 3]
    create:
      tile_2: { name: tile_1_name }
      tile_1: { name: tile_1_name }
      button_start:
    modify:
      tile_1:
        # position: [right_from_left 60vw, 0]
        position: [right_from_left 89vw, 0]
        misc:
          landmark_index: landmark_index
      tile_2:
        # position: [right 50, 0]
        position: [right 0, 0]
        misc:
          # extra_dot: [100, 100]
          image_opacity: 0  # added this!!
          landmark_index: landmark_index  # added this!!
          extra_scale: tile_2_scale
    event_handling:
      correctness: move_dot
      arg_1: tile_1
      touch_reveals_button: submit
    misc:
      config_iteration: 4
      num_stars: 3
      blank_between_exercises: 500
      remove_on_exit: [button_submit]
      freeze_display: true
  just_dot:
    params:
      event_handling:
        target: tile_2
        move: move_dot
  with_handle:
    params:
      create:
        door_2: [1]
        door_1: [1]
      modify:
        door_1:
          position: [60vw, 0]
          misc:
            extra_scale: tile_1_height
        door_2:
          position: [right 50, 0]
          misc:
            handle_opacity: 0
            extra_scale: tile_2_height
      event_handling:
        target: door_2
        move: move_handle_dot
      delay:
        modify:
          door_2:
            anim_info: { blink: [0, 1] }
    with_dot:
      params:
      level_1:
      level_2:
        params:
          delay:
            modify:
              tile_2:
                anim_info: { opacity: [1, 0], duration: 3000 }
      level_3:
        params:
          delay:
            modify:
              tile_2:
                anim_info: { opacity: [1, 0], duration: 500 }
      level_4:
        params:
          modify:
            tile_2:
              anim_info:
                opacity: [1, 0]
                duration: 1000
        door_9:
    both_animals:
      params:
        misc:
          hide_dot: true
      level_1:
      level_2:
        params:
          modify:
            tile_2:
              anim_info: { opacity: [1, 0], duration: 1000 }
    one_animal:
      params:
        modify:
          tile_2:
            style: {opacity: 0}
        misc:
          hide_dot: true
    just_doors:
      params:
        modify:
          tile_1:
            style: {opacity: 0}
          tile_2:
            style: {opacity: 0}
        misc:
          hide_dot: true
      level_1:
proportion:
  params:
    generate: { portal_1_name: [uniform, .2, .9],
                door_2_name: [uniform, .1, .9],
                # door_2_name: [fixed, .5],
                door_3_name: portal_1_name * door_2_name,
                restriction_2: door_3_name < door_2_name }
    create:
      portal_1: { name:  [1, portal_1_name] }
      door_2: { name: [door_2_name] }
      door_3: { name: [door_3_name] }
      err_box:
    modify:
      portal_1: { position: [0, 0], misc: {stealth_mode: true} }
      door_2: { position: [220, 0], misc: {handle_color: orange} }
      door_3:
        position: [320, 0]
        style: { opacity: 1 }
        anim_info: { blink: [0, 1] }
        misc:
          handle_opacity: 0
          handle_color: orange
          extra_scale: portal_1_name
    event_handling:
      arg_1: portal_1
      arg_2: door_2
      result: door_3
      correctness: near_height
      top_right_text: average_error
      just_proportion: true
      move: move_handle
      target: door_3
      show_camel: true
      slide_portal: false
      touch_reveals_button: submit
      star_policy: loose
    misc:
      config_iteration: 4
      num_stars: 3
      remove_on_exit: [err_box]
      blank_between_exercises: 500
  option:
    # skip_node_above:
    params:
      generate:
        # portal_1_name: [fixed, .75]
        # door_2_name: [fixed, .25]
        extra_name: door_2_name / portal_1_name
        option_value_delta: 0.2
        # option_value_delta: 0
        option_value_seed: door_2_name
        # option_value_seed: .5
        restriction_3: option > 0
        restriction_4: option < 1
        restriction_5: option < extra_name
      modify:
        door_3:
          position: [0, 0]
          anim_info: null
          misc:
            is_option: true
            handle_opacity: null
      event_handling:
        show_camel: null
    pure_copy:
      params:
        generate:
          restriction_2: null
          restriction_5: null
        create:
          portal_1: { name:  [portal_1_name, portal_1_name] }
        misc:
          config_iteration: 3
      level_1: { params: { generate: { portal_1_name: [fixed, 1] } } }
      level_2:
        params:
          generate: { portal_1_name: [fixed, 1] }
          modify:
            portal_1:
              appear_after: 500
              anim_info: { opacity: [1, 0], delay: 1000, duration: 500 }
            door_2:
              appear_after: 500
              anim_info: { opacity: [1, 0], delay: 1000, duration: 500 }
            door_3:
              appear_after: 1500
      level_3: { params: { generate: { portal_1_name: [fixed, .5] } } }
      level_4:
        params:
          generate: { portal_1_name: [fixed, .5] }
          modify:
            portal_1:
              appear_after: 500
              anim_info:
                opacity: [1, 0]
                delay: 1000
                duration: 500
            door_2:
              appear_after: 500
              anim_info:
                opacity: [1, 0]
                delay: 1000
                duration: 500
            door_3:
              appear_after: 1500
      level_5: { params: { generate: { portal_1_name: [fixed, .25] } } }
      level_6:
        params:
          generate: { portal_1_name: [fixed, .25] }
          modify:
            portal_1:
              appear_after: 500
              anim_info:
                opacity: [1, 0]
                delay: 1000
                duration: 500
            door_2:
              appear_after: 500
              anim_info:
                opacity: [1, 0]
                delay: 1000
                duration: 500
            door_3:
              appear_after: 1500
    zoom_down:
      params:
        generate:
          restriction_5: null
      level_1:
        params:
          modify:
            portal_1:
              zoom_anim:
                source: 1
                target: portal_1_name
                time: [ {delay: 1000, duration: 1000} ]
            door_3:
              appear_after: 3000
          misc:
            skip_slide_down: true
      level_2:
        params:
          modify:
            portal_1:
              zoom_anim:
                source: 1
                target: portal_1_name
                time: [ {delay: 1000, duration: 500} ]
            door_3:
              appear_after: 2500
    bounce:
      params:
      level_1:
        params:
          generate: { door_2_name: [fixed, .5] }
          modify:
            portal_1:
              zoom_anim:
                source: 1
                target: portal_1_name
                time: [ {delay: 1000, duration: 500}, {delay: 2000, duration: 250} ]
            door_3:
              appear_after: 4500
      level_2:
        params:
          generate: { door_2_name: [pick_from_list, [.25, .5, .75]] }
          modify:
            portal_1:
              zoom_anim:
                source: 1
                target: portal_1_name
                time: [ {delay: 1000, duration: 250}, {delay: 1000, duration: 250} ]
            door_3:
              appear_after: 3500
      level_3:
        params:
          modify:
            portal_1:
              zoom_anim:
                source: 1
                target: portal_1_name
                time: [ {delay: 1000, duration: 250}, {delay: 500, duration: 500} ]
            door_3:
              appear_after: 3000
    no_bounce:
      params:
        modify:
          door_3:
            appear_after: 1000
      level_1:
        params:
          generate: { door_2_name: [fixed, .5] }
      level_2:
        params:
          generate: { door_2_name: [pick_from_list, [.25, .5, .75]] }
      level_3:
      level_4:
        params:
          generate:
            restriction_5: null
  # here are the original levels that do not use options
  pure_copy:
    skip_node_above:
    params:
      generate: { restriction_2: null }
      create:
        portal_1: { name:  [portal_1_name, portal_1_name] }
    level_1: { params: { generate: { portal_1_name: [fixed, 1] } } }
    level_2: { params: { generate: { portal_1_name: [fixed, .5] } } }
    level_3: { params: { generate: { portal_1_name: [fixed, .25] } } }
  zoom_down:
    skip_node_above:
    params:
    level_1:
      params:
        modify:
          portal_1:
            zoom_anim:
              source: 1
              target: portal_1_name
              time: [ {delay: 1000, duration: 1000} ]
          door_3:
            appear_after: 3000
            anim_info: { blink: [0, 1], delay: 3000 }
        misc:
          skip_slide_down: true
    level_2:
      params:
        modify:
          portal_1:
            zoom_anim:
              source: 1
              target: portal_1_name
              time: [ {delay: 1000, duration: 500} ]
          door_3:
            appear_after: 2500
            anim_info: { blink: [0, 1], delay: 2500 }
  bounce:
    skip_node_above:
    params:
    level_1:
      params:
        generate: { door_2_name: [fixed, .5] }
        modify:
          portal_1:
            zoom_anim:
              source: 1
              target: portal_1_name
              time: [ {delay: 1000, duration: 500}, {delay: 2000, duration: 250} ]
          door_3:
            appear_after: 4500
            anim_info: { blink: [0, 1], delay: 4500 }
    level_2:
      params:
        generate: { door_2_name: [pick_from_list, [.25, .5, .75]] }
        modify:
          portal_1:
            zoom_anim:
              source: 1
              target: portal_1_name
              time: [ {delay: 1000, duration: 250}, {delay: 1000, duration: 250} ]
          door_3:
            appear_after: 3500
            anim_info: { blink: [0, 1], delay: 3500 }
    level_3:
      params:
        modify:
          portal_1:
            zoom_anim:
              source: 1
              target: portal_1_name
              time: [ {delay: 1000, duration: 250}, {delay: 500, duration: 500} ]
          door_3:
            appear_after: 3000
            anim_info: { blink: [0, 1], delay: 3000 }
  no_bounce:
    params:
      modify:
        door_3:
          appear_after: 1000
          anim_info: { blink: [0, 1], delay: 1000 }
    level_1:
      params:
        generate: { door_2_name: [fixed, .5] }
    level_2:
      params:
        generate: { door_2_name: [pick_from_list, [.25, .5, .75]] }
    level_3:
    level_4:
multiply_height:
  params:
    generate: { portal_1_name: [uniform, .1, .9],
                door_3_name: [uniform, .1, .9], }
    create:
      door_3: { name: [door_3_name] }
      # door_3: [0.29]
      # portal_1: { name: [1] }
      portal_1: [1.]
      # tower_1: { name: [.5, .3] }
      # button_submit:
    modify:
      portal_1: { position: [0, 0], anim_info: { handle_blink: [0, 1] } }
      door_3: { position: [320, 0], misc: {handle_color: orange} }
      # tower_1: { position: [50vw, 0] }
    event_handling:
      arg_1: portal_1
      result: door_3
      correctness: near_height
      top_right_text: average_error
      slide_portal: true
    misc:
      config_iteration: 2
      num_stars: 3
      remove_on_exit: [err_box]
      blank_between_exercises: 500
  animal_target:
    params:
      generate: { tile_2_name: [pick_animal_name],
                  restriction_1: tile_2_name < 1.0,
                  restriction_2: door_3_name < tile_2_name }
      create:
        # tile_2: { name: "puppy" }
        tile_2: { name: tile_2_name }
      modify:
        tile_2: { position: [right_from_left 280, 0] }
      event_handling:
        arg_2: tile_2
        target: portal_1
    touch_image:
      params:
        modify:
          portal_1: { position: [0, 0], anim_info: null }
          tile_2:
            anim_info: { blink: [.5, 1] }
        event_handling:
          move: touch_image
          star_policy: extraLoose
    move_handle:
      params:
        event_handling:
          move: move_handle
          star_policy: loose
  door_target:
    params:
      generate: { door_2_name: [uniform, .1, .9],
                  door_3_name: portal_1_name * door_2_name,
                  restriction_2: door_3_name < door_2_name }
      create:
        door_2: { name: [door_2_name] }
        # door_2: [.5]
      modify:
        door_2: { position: [220, 0], misc: {handle_color: orange} }
      event_handling: { arg_2: door_2, move: move_handle }
    move_portal_handle_to_match:
      params:
        event_handling:
          target: portal_1
          star_policy: moderate
    move_portal_handle_to_shadow:
      params:
        create:
          portal_1: { name: [1, portal_1_name] }
          button_submit: remove
        modify:
          door_3: { style: {opacity: 0} }
        event_handling:
          target: portal_1
          star_policy: strict
      level_1:
      levels_with_stages:
        params:
          misc:
            config_iteration: null
            problem_stage: true
            skip_submit: true
            skip_in_between: true
        level_2a:
        level_2b:
          params:
            modify:
              portal_1: { anim_info: null }
              door_3:
                style: {opacity: 1}
                anim_info: { blink: [0, 1] }
                misc:
                  handle_opacity: 0
            event_handling:
              target: door_3
            misc:
              skip_submit: null
              skip_in_between: null
              problem_stage: null
              goto_config: [2, ['multiply_height', 'door_target',
                'move_portal_handle_to_shadow', 'levels_with_stages', 'level_2a']]
              remove_on_exit: [err_box, button_submit]
        level_3a:
          params:
            event_handling:
              return_to_top: portal_1
        level_3b:
          params:
            create:
              err_box:
              button_submit:
            modify:
              portal_1: { anim_info: null }
              door_3:
                style: {opacity: 1}
                anim_info: { blink: [0, 1] }
                misc:
                  handle_opacity: 0
            event_handling:
              target: door_3
              show_camel: true
              slide_portal: false
            misc:
              skip_submit: null
              skip_in_between: null
              problem_stage: null
              goto_config: [2, ['multiply_height', 'door_target',
                'move_portal_handle_to_shadow', 'levels_with_stages', 'level_3a']]
              remove_on_exit: [err_box, button_submit]
    actual_multiplication:
      params:
        create:
          portal_1: { name:  [1, portal_1_name] }
          err_box:
        modify:
          portal_1: { anim_info: null }
          door_3:
            style: {opacity: 1}
            anim_info: { blink: [0, 1] }
            misc:
              handle_opacity: 0
              handle_color: orange
        event_handling:
          target: door_3
          show_camel: true
          slide_portal: false
          touch_reveals_button: submit
          star_policy: loose
      level_1:
        params:
          generate: { door_2_name: [fixed, .5] }
      level_2:
intro_diagrams_2:
  params:
    generate: { tower_1_name: [pick_from_range, .1, 3.8, .1] }
    create:
      tower_1: { name: tower_1_name }
      tower_2: []
    modify:
      tower_1:
        position: [5, 0]
        tower_style: {opacity: 0}
      tower_2:
        position: [65vw, 0]
        tower_style: {opacity: 0}
        misc:
          tower_name_style: { left: 5 }
    event_handling:
      comparison_source: tower_1
      target: tower_2
      correctness: identical
      touch_reveals_button: [submit, delete]
    misc:
      new_scale_factor: 200
      config_iteration: 7
      num_stars: 3
      remove_on_exit: [button_submit, button_delete]
  level_1:
    params:
      create:
        keypad_kind: 'buildTower'
      modify:
        tower_1:
          width: 50vw
          overflow: hidden
          tower_style: {opacity: null}
          misc:
            hide_tower_name: true
  level_2:
    params:
      modify:
        tower_2:
          tower_style: {opacity: null}
          misc:
            hide_tower_name: true
            as_diagram: true
      event_handling:
        create_tower_by_height: true
tower_1_2:
  params:
    generate:
      # mean_name_base_5: [pick_from_list, [[.5, .5], [1, .5, .5]]]
      mean_name_base_5: [pick_from_list, [[.5,.5, .5,.5, .5,.5], [1, .5,.5, .5,.5], [2, .5,.5], [.5,.5, .5,.5], [1, .5,.5], [.5,.5]]]
      extra_delta: [pick_from_range, 0, .45, .1]
      extra_fiver: [pick_from_list, [0, .5]]
      mean_name_f: mean_name_base_5 ++ extra_fiver
      mean_name: mean_name_f ++ extra_delta
    create:
      tower_1: { name: tower_1_name }
      tower_2: { name: tower_2_name }
      button_submit:
      tower_moving: []
    modify:
      tower_1:
        position: [5vw, 0]
        width: 50vw
        overflow: 'hidden'
      tower_2:
        position: [70vw, 0]
        # misc:
        #   selected_block_index: 1
        #   num_selected_blocks: 2
      tower_moving:
        position: [0, 0]
        width: 50vw
        overflow: 'hidden'
        # anim_info:
        #   left: [0, -70]
        #   duration: 1000
        misc:
          hide_tower_name: true
    event_handling:
      target: tower_2
      comparison_source: tower_1
      moving: tower_moving
      correctness: identical
      swipe_tower: true
      no_split_fiver: true
      minimum_split_size: -1
    misc:
      new_scale_factor: 200
      config_iteration: 4
      num_stars: 2
  level_1:
    params:
      generate:
        # tower_1_name: [fixed, [1, .5, .2]]
        # tower_2_name: [fixed, [.5, .5, .5, .2]]
        # tower_2_name: [fixed, [.5, .5, .5, .1, .05, .05]]
        # tower_2_name: [fixed, [.5, .5, .5, .1, .05, .01, .01, .01, .01, .01]]
        tower_1_name: standardize_name mean_name
        tower_2_name: mean_name
      event_handling:
        minimum_split_size: 100
  level_2:
    params:
      generate:
        # tower_1_name: [fixed, [.5, .5, .5, .2]]
        tower_1_name: mean_name
        # tower_2_name: [fixed, [1, .5, .2]]
        tower_2_name: standardize_name mean_name
      event_handling:
        minimum_split_size: -1
  diagrams:
    params:
      modify:
        tower_1:
          misc:
            as_diagram: true
        tower_2:
          misc:
            as_diagram: true
        tower_moving:
          misc:
            as_diagram: true
      event_handling:
        minimum_split_size: -1
    level_3:
      params:
        generate:
          tower_1_name: standardize_name mean_name
          tower_2_name: mean_name
    level_4:
      params:
        generate:
          tower_1_name: mean_name
          tower_2_name: standardize_name mean_name
group_ungroup:
  params:
    generate: # { tower_1_name: [pick_from_range, .1, 3.8, .1] }
      mean_name_base_5: [pick_from_list, [[.5,.5, .5,.5, .5,.5], [1, .5,.5, .5,.5], [2, .5,.5], [.5,.5, .5,.5], [1, .5,.5], [.5,.5]]]
      # mean_name_base_5: [pick_from_list, [[.5,.5]]]
      extra_fiver: [pick_from_list, [0, .5]]
      extra_delta: [pick_from_range, 0, .45, .1]
      mean_name_f: mean_name_base_5 ++ extra_fiver
      mean_name: mean_name_f ++ extra_delta
      # mean_name: [fixed, [2, .5, .5, .5, .4]]
      tower_1_name: mean_name
    create:
      tower_1: { name: tower_1_name }
      tower_mid: []
      tower_2: []
      tower_moving: []
    modify:
      tower_1:
        position: [5, 0]
        tower_style: {opacity: 0}
      tower_mid:
        position: [40vw, 0]
        misc:
          hide_tower_name: true
      tower_2:
        position: [right 10vw, 0]
        tower_style: {opacity: 0}
        misc:
          tower_name_style: { left: 5 }
      tower_moving:
        position: [0, 0]
        misc:
          hide_tower_name: true
    event_handling:
      correctness: identical
      touch_reveals_button: [submit, delete]
      no_split_fiver: true
      minimum_split_size: -1
    misc:
      new_scale_factor: 200
      num_stars: 2
      remove_on_exit: [button_submit, button_delete]
      # config_iteration: 7
      # when ready to tie the different stages together:
      config_iteration: null
      problem_stage: true
      skip_in_between: true
      # skip_submit: true
  stage_1:
    params_from: [grouping_snippet_stage_1]
  stage_2:
    params_from: [grouping_snippet_stage_2]
  stage_3:
    params_from: [grouping_snippet_stage_3]
    params:
      misc:
        goto_config: [4, [group_ungroup, stage_1]]
  just_diagram:
    params:
      modify:
        tower_mid:
          misc:
            as_diagram: true
        tower_moving:
          misc:
            as_diagram: true
    stage_1:
      params_from: [grouping_snippet_stage_1]
    stage_2:
      params_from: [grouping_snippet_stage_2]
    stage_3:
      params_from: [grouping_snippet_stage_3]
      params:
        misc:
          goto_config: [2, [group_ungroup, just_diagram, stage_1]]
  direct:
    params_from: [grouping_direct_snippet]
    level_1:
    level_2:
      params:
        modify:
          tower_mid:
            anim_info:
              opacity: [1, 0]
              delay: 500
              duration: 1000
    level_3:
      params:
        modify:
          tower_mid:
            style: {opacity: 0}
  ungroup:
    params:
      generate:
        tower_1_name: standardize_name mean_name
      create:
        tower_4: mean_name
      modify:
        tower_1:
          position: [75vw, 0]
        tower_2:
          position: [10vw, 0]
        tower_4:
          position: [10vw, 400]
          style: {opacity: 0}
          tower_style: {opacity: 0}
          misc:
            tower_name_style: { left: 5 }
            show_only_fivers: true
            show_only_size: -1
    stage_1:
      skip_node_above:
      params_from: [grouping_snippet_stage_1_un]
    stage_2:
      skip_node_above:
      params_from: [grouping_snippet_stage_2_un]
    stage_3:
      skip_node_above:
      params_from: [grouping_snippet_stage_3_un]
      params:
        misc:
          goto_config: [4, [group_ungroup, ungroup, stage_1]]
    just_diagram:
      skip_node_above:
      params:
        modify:
          tower_mid:
            misc:
              as_diagram: true
          tower_moving:
            misc:
              as_diagram: true
      stage_1:
        params_from: [grouping_snippet_stage_1_un]
      stage_2:
        params_from: [grouping_snippet_stage_2_un]
      stage_3:
        params_from: [grouping_snippet_stage_3_un]
        params:
          misc:
            goto_config: [2, [group_ungroup, ungroup, just_diagram, stage_1]]
    direct:
      params_from: [grouping_direct_snippet_un]
      level_1:
        params_from: [grouping_snippet_stage_2_un_plus]
      level_2:
      level_3:
        params:
          modify:
            tower_mid:
              anim_info:
                opacity: [1, 0]
                delay: 500
                duration: 1000
      level_4:
        params:
          modify:
            tower_mid:
              style: {opacity: 0}
  singletons:
    params:
      generate:
        # mean_name_base_1: [pick_from_list, [[.3,.4]]]
        mean_name_base_1: [pick_from_list, [[.3,.3], [.4,.2], [.2,.4], [.4,.3], [.3,.4], [.4,.4]]]
        extra_box: [pick_from_range, 0, 2.1, 1]
        mean_name: extra_box ++ mean_name_base_1
      event_handling:
        expand_into_units: true  # to allow .3, .4 == .4, .3
    stage_1:
      skip_node_above:
      params_from: [grouping_snippet_stage_1]
    stage_2:
      skip_node_above:
      params_from: [grouping_snippet_stage_2]
    stage_3:
      skip_node_above:
      params_from: [grouping_snippet_stage_3]
      params:
        misc:
          goto_config: [4, [group_ungroup, singletons, stage_1]]
    just_diagram:
      skip_node_above:
      params:
        modify:
          tower_mid:
            misc:
              as_diagram: true
          tower_moving:
            misc:
              as_diagram: true
      stage_1:
        params_from: [grouping_snippet_stage_1]
      stage_2:
        params_from: [grouping_snippet_stage_2]
      stage_3:
        params_from: [grouping_snippet_stage_3]
        params:
          misc:
            goto_config: [2, [group_ungroup, singletons, just_diagram, stage_1]]
    direct:
      params_from: [grouping_direct_snippet]
      params:
        misc:
          config_iteration: 7
          num_stars: 3
      level_1:
        params:
      level_2:
        params:
          modify:
            tower_mid:
              anim_info:
                opacity: [1, 0]
                delay: 500
                duration: 1000
      level_3:
        params:
          modify:
            tower_mid:
              style: {opacity: 0}
    ungroup:
      params:
        generate:
          mean_name_base_1: [pick_from_list, [[.4,.2], [.4,.3], [.4,.4]]]
          tower_1_name: standardize_name mean_name
        create:
          tower_4: mean_name
        modify:
          tower_1:
            position: [75vw, 0]
          tower_2:
            position: [5vw, 0]
          tower_4:
            position: [20vw, 400]
            style: {opacity: 0}
            tower_style: {opacity: 0}
            misc:
              tower_name_style: { left: 5 }
              show_only_singletons: true
              show_only_size: -1
        event_handling:
          no_split_fiver: false
      stage_1:
        skip_node_above:
        params_from: [grouping_snippet_stage_1_un]
      stage_2:
        skip_node_above:
        params_from: [grouping_snippet_stage_2_un]
      stage_3:
        skip_node_above:
        params_from: [grouping_snippet_stage_3_un]
        params:
          misc:
            goto_config: [4, [group_ungroup, singletons, ungroup, stage_1]]
      direct:
        params_from: [grouping_direct_snippet_un]
        level_1:
          params_from: [grouping_snippet_stage_2_un_plus]
        level_2:
          params:
        level_3:
          params:
            modify:
              tower_mid:
                anim_info:
                  opacity: [1, 0]
                  delay: 500
                  duration: 1000
        level_4:
          params:
            modify:
              tower_mid:
                style: {opacity: 0}
  singletons_separate_fivers:
    params:
      generate:
        mean_name_base_1: [pick_from_list, [[.3,.3], [.4,.2], [.2,.4], [.4,.3], [.3,.4], [.4,.4]]]
        mean_name_base_5: [pick_from_list, [[.5,.5, .5,.5, .5,.5], [1, .5,.5, .5,.5], [2, .5,.5], [.5,.5, .5,.5], [1, .5,.5], [.5,.5]]]
        mean_name: mean_name_base_5 ++ mean_name_base_1
      event_handling:
        expand_into_units: true  # to allow .3, .4 == .4, .3
    stage_1:
      skip_node_above:
      params_from: [grouping_snippet_stage_1]
    stage_2:
      skip_node_above:
      params_from: [grouping_snippet_stage_2]
    stage_3:
      skip_node_above:
      params_from: [grouping_snippet_stage_3]
      params:
        misc:
          goto_config: [4, [group_ungroup, singletons_separate_fivers, stage_1]]
    just_diagram:
      skip_node_above:
      params:
        modify:
          tower_mid:
            misc:
              as_diagram: true
          tower_moving:
            misc:
              as_diagram: true
      stage_1:
        params_from: [grouping_snippet_stage_1]
      stage_2:
        params_from: [grouping_snippet_stage_2]
      stage_3:
        params_from: [grouping_snippet_stage_3]
        params:
          misc:
            goto_config: [2, [group_ungroup, singletons_separate_fivers, just_diagram, stage_1]]
    direct:
      params_from: [grouping_direct_snippet]
      level_1:
        params:
      level_2:
        params:
          modify:
            tower_mid:
              anim_info:
                opacity: [1, 0]
                delay: 500
                duration: 1000
      level_3:
        params:
          modify:
            tower_mid:
              style: {opacity: 0}
    ungroup:
      params:
        generate:
          mean_name_base_1: [pick_from_list, [[.4,.2], [.4,.3], [.4,.4]]]
          tower_1_name: standardize_name mean_name
        create:
          tower_4: mean_name
        modify:
          tower_1:
            position: [75vw, 0]
          tower_2:
            position: [10vw, 0]
          tower_4:
            position: [10vw, 400]
            style: {opacity: 0}
            tower_style: {opacity: 0}
            misc:
              tower_name_style: { left: 5 }
              show_only_size: -1
        event_handling:
          no_split_fiver: false
      stage_1:
        skip_node_above:
        params_from: [grouping_snippet_stage_1_un]
      stage_2:
        skip_node_above:
        params_from: [grouping_snippet_stage_2_un]
      stage_3:
        skip_node_above:
        params_from: [grouping_snippet_stage_3_un]
        params:
          misc:
            goto_config: [2, [group_ungroup, singletons_separate_fivers, ungroup, stage_1]]
      direct:
        params_from: [grouping_direct_snippet_un]
        level_1:
          params_from: [grouping_snippet_stage_2_un_plus]
        level_2:
        level_3:
          params:
            modify:
              tower_mid:
                anim_info:
                  opacity: [1, 0]
                  delay: 500
                  duration: 1000
        level_4:
          params:
            modify:
              tower_mid:
                style: {opacity: 0}
  singletons_with_a_fiver:
    params:
      generate:
        mean_name_base_1: [pick_from_list, [[.3,.3], [.4,.2], [.2,.4], [.4,.3], [.3,.4], [.4,.4]]]
        extra_box: [pick_from_range, 0, 2.1, 1]
        extra_fiver: [fixed, 0.5]
        mean_name_f: extra_box ++ extra_fiver
        mean_name: mean_name_f ++ mean_name_base_1
      event_handling:
        expand_into_units: true  # to allow .3, .4 == .4, .3
    stage_1:
      skip_node_above:
      params_from: [grouping_snippet_stage_1]
    stage_2:
      skip_node_above:
      params_from: [grouping_snippet_stage_2]
    stage_3:
      skip_node_above:
      params_from: [grouping_snippet_stage_3]
      params:
        misc:
          goto_config: [4, [group_ungroup, singletons_with_a_fiver, stage_1]]
    direct:
      params_from: [grouping_direct_snippet]
      level_1:
        params:
      level_2:
        params:
          modify:
            tower_mid:
              anim_info:
                opacity: [1, 0]
                delay: 500
                duration: 1000
      level_3:
        params:
          modify:
            tower_mid:
              style: {opacity: 0}
  singletons_with_fivers:
    params:
      generate:
        mean_name_base_1: [pick_from_list, [[.1, .2], [.3, .1], [.3,.3], [.4,.2], [.2,.4], [.4,.3], [.3,.4], [.4,.4]]]
        mean_name_base_5: [pick_from_list, [[.5,.5, .5,.5, .5,.5], [1, .5,.5, .5,.5], [2, .5,.5], [.5,.5, .5,.5], [1, .5,.5], [.5,.5]]]
        extra_fiver: [pick_from_list, [0, .5, .5, .5, .5]]
        mean_name_f: mean_name_base_5 ++ extra_fiver
        mean_name: mean_name_f ++ mean_name_base_1
      event_handling:
        expand_into_units: true  # to allow .3, .4 == .4, .3
    stage_1:
      skip_node_above:
      params_from: [grouping_snippet_stage_1]
    stage_2:
      skip_node_above:
      params_from: [grouping_snippet_stage_2]
    stage_3:
      skip_node_above:
      params_from: [grouping_snippet_stage_3]
      params:
        misc:
          goto_config: [4, [group_ungroup, singletons_separate_fivers, stage_1]]
    just_diagram:
      skip_node_above:
      params:
        modify:
          tower_mid:
            misc:
              as_diagram: true
          tower_moving:
            misc:
              as_diagram: true
      stage_1:
        params_from: [grouping_snippet_stage_1]
      stage_2:
        params_from: [grouping_snippet_stage_2]
      stage_3:
        params_from: [grouping_snippet_stage_3]
        params:
          misc:
            goto_config: [2, [group_ungroup, singletons_separate_fivers, just_diagram, stage_1]]
    direct:
      params_from: [grouping_direct_snippet]
      level_1:
        params:
      level_2:
        params:
          modify:
            tower_mid:
              anim_info:
                opacity: [1, 0]
                delay: 500
                duration: 1000
      level_3:
        params:
          modify:
            tower_mid:
              style: {opacity: 0}
    ungroup:
      params:
        generate:
          mean_name_base_1: [pick_from_list, [[.4,.2], [.4,.3], [.4,.4]]]
          tower_1_name: standardize_name mean_name
        create:
          tower_4: mean_name
        modify:
          tower_1:
            position: [75vw, 0]
          tower_2:
            position: [10vw, 0]
          tower_4:
            position: [10vw, 400]
            style: {opacity: 0}
            tower_style: {opacity: 0}
            misc:
              tower_name_style: { left: 5 }
              show_only_size: -1
        event_handling:
          no_split_fiver: false
      stage_1:
        skip_node_above:
        params_from: [grouping_snippet_stage_1_un]
      stage_2:
        skip_node_above:
        params_from: [grouping_snippet_stage_2_un]
      stage_3:
        skip_node_above:
        params_from: [grouping_snippet_stage_3_un]
        params:
          misc:
            goto_config: [4, [group_ungroup, singletons_separate_fivers, ungroup, stage_1]]
      just_diagram:
        skip_node_above:
        params:
          modify:
            tower_mid:
              misc:
                as_diagram: true
            tower_moving:
              misc:
                as_diagram: true
        stage_1:
          params_from: [grouping_snippet_stage_1_un]
        stage_2:
          params_from: [grouping_snippet_stage_2_un]
        stage_3:
          params_from: [grouping_snippet_stage_3_un]
          params:
            misc:
              goto_config: [2, [group_ungroup, singletons_separate_fivers, ungroup, just_diagram, stage_1]]
      direct:
        params_from: [grouping_direct_snippet_un]
        level_1:
          params_from: [grouping_snippet_stage_2_un_plus]
        level_2:
        level_3:
          params:
            modify:
              tower_mid:
                anim_info:
                  opacity: [1, 0]
                  delay: 1000
                  duration: 2000
        level_4:
          params:
            modify:
              tower_mid:
                style: {opacity: 0}
  jump_to_next:
    params:
      event_handling:
        create_tower_by_height: true
        comparison_source: tower_1
        target: tower_mid
        allow_non_standard: true
      misc:
        skip_in_between: null
        problem_stage: null
        config_iter: 1
        jmp: [add_or_half, as_option, result_option, stack, bars, level_1]
tower_variations:
  params:
    generate:
      mean_names_base_5: [fixed, [[.5,.5, .5,.5, .5,.5], [1, .5,.5, .5,.5], [2, .5,.5], [.5,.5, .5,.5], [1, .5,.5], [.5,.5]]]
      extra_fiver: [fixed, [0, .5]]
      extra_delta: [fixed, [0, .1, .2, .3, .4]]
      mean_names_f: mean_names_base_5 +*+ extra_fiver
      mean_names: mean_names_f +*+ extra_delta
      one_height: [pick_from_range, 1.5, 3.5, .1]
      narrowed_names: narrow_table mean_names one_height
      delay_option_value_delta: augment_table narrowed_names
      10_option_value_seed: one_height   # the 10_ is to delay!
      # mean_name: [fixed, [2, .5, .5, .5, .4]]
      # tower_1_name: mean_name
      # tower_1_name: [pick_from_range, .1, 1.8, .1]
      # tower_1_name: [fixed, 1.1]
    create:
      # tower_1: { name: tower_1_name }
      tower_1: { name: one_height }
      tower_2: []
      # button_submit: 'on_right'
    modify:
      tower_1:
        position: [left_from_right 150, 0]
        misc:
          tower_name_style: { left: 25 }
      tower_2:
        position: [5, 0]
        misc:
          tower_name_style: { left: 25 }
          hide_overflow: true
          is_option: true
          option_offset: 5
          option_width: 120
          option_button_choice: [0, 0, 0, 0]
    event_handling:
      comparison_source: tower_1
      arg_1: tower_1
      target: tower_2
      correctness: option_button
      use_option_buttons: true
    misc:
      new_scale_factor: 200
      config_iteration: 4
      num_stars: 2
      remove_on_exit: [button_submit]
  level_1:
  level_2:
    params_from: [tower_2_disappearing_snippet]
  # level_3:
  #   params_from: [tower_2_disappeared_snippet]
  singletons:
    params:
      generate:
        mean_names_base_1: [fixed, [[.3,.3], [.4,.2], [.2,.4], [.4,.3], [.3,.4], [.4,.4]]]
        extra_box: [fixed, [0, 1, 2]]
        mean_names: extra_box +*+ mean_names_base_1
        one_height: [pick_from_list, [.6, .7, .8, 1.6, 1.7, 1.8, 2.6, 2.7, 2.9]]
    level_1:
    level_2:
      params_from: [tower_2_disappearing_snippet]
    # level_3:
    #   params_from: [tower_2_disappeared_snippet]
  singletons_separate_fivers:
    params:
      generate:
        mean_names_base_5: [fixed, [[.5,.5, .5,.5, .5,.5], [1, .5,.5, .5,.5], [2, .5,.5], [.5,.5, .5,.5], [1, .5,.5], [.5,.5]]]
        mean_names_base_1: [fixed, [[.3,.3], [.4,.2], [.2,.4], [.4,.3], [.3,.4], [.4,.4]]]
        mean_names: mean_names_base_5 +*+ mean_names_base_1
        one_height: [pick_from_list, [1.6, 1.7, 1.8, 2.6, 2.7, 2.8, 3.6, 3.7, 3.8]]
      event_handling:
        expand_into_units: true  # to allow .3, .4 == .4, .3
    level_1:
    level_2:
      params_from: [tower_2_disappearing_snippet]
    # level_3:
    #   params_from: [tower_2_disappeared_snippet]
  singletons_with_a_fiver:
    params:
      generate:
        mean_names_base_1: [fixed, [[.3,.3], [.4,.2], [.2,.4], [.4,.3], [.3,.4], [.4,.4]]]
        extra_box: [fixed, [[], [1], [2]]]
        extra_fiver: [fixed, [0.5]]
        mean_names_f: extra_box +*+ extra_fiver
        mean_names: mean_names_f +*+ mean_names_base_1
        one_height: [pick_from_list, [1.1, 1.2, 1.3, 2.1, 2.2, 2.3, 3.1, 3.2, 3.3]]
      event_handling:
        expand_into_units: true  # to allow .3, .4 == .4, .3
    level_1:
    level_2:
      params_from: [tower_2_disappearing_snippet]
    # level_3:
    #   params_from: [tower_2_disappeared_snippet]
  singletons_with_fivers:
    params:
      generate:
        mean_names_base_5: [fixed, [[.5,.5, .5,.5, .5,.5], [1, .5,.5, .5,.5], [2, .5,.5], [.5,.5, .5,.5], [1, .5,.5], [.5,.5]]]
        mean_names_base_1: [fixed, [[.1, .2], [.3, .1], [.3,.3], [.4,.2], [.2,.4], [.4,.3], [.3,.4], [.4,.4]]]
        extra_fiver: [fixed, [0, .5]]
        mean_names_f: mean_names_base_5 +*+ extra_fiver
        mean_names: mean_names_f +*+ mean_names_base_1
        one_height: [pick_from_range, 1.5, 4.15, .1]
      event_handling:
        expand_into_units: true  # to allow .3, .4 == .4, .3
    level_1:
    level_2:
      params_from: [tower_2_disappearing_snippet]
    # level_3:
    #   params_from: [tower_2_disappeared_snippet]
drag_blocks:
  params:
    generate: # { tower_1_name: [pick_from_range, .1, 3.8, .1] }
      mean_name_base_1: [pick_from_list, [[.1, .2], [.3, .1], [.3,.3], [.4,.2], [.2,.4], [.4,.3], [.3,.4], [.4,.4]]]
      mean_name_base_5: [pick_from_list, [[.5,.5, .5,.5, .5,.5], [1, .5,.5, .5,.5], [2, .5,.5], [.5,.5, .5,.5], [1, .5,.5], [.5,.5]]]
      extra_fiver: [pick_from_list, [0, .5, .5, .5, .5]]
      mean_name_f: mean_name_base_5 ++ extra_fiver
      mean_name: mean_name_f ++ mean_name_base_1
      # mean_name: [fixed, [.3, .3]]
      nice_name: standardize_name mean_name
      partition_1: mean_name into m1 and m2
    create:
      big_paren: true
      big_op: +
      tower_2_shadow: { name: m2 }
      tower_1_shadow: { name: m1 }
      tower_result: { name: mean_name }
      tower_2: { name: m2 }
      tower_1: { name: m1 }
    modify:
      big_paren:
        position: [20, 0]
        style: { width: 500 }
      big_op:
        position: [205, 0]
      tower_1:
        position: [15, 0]
        misc:
          tower_name_style: { left: 25 }
          swap_channel: '12'
          draggable: all
      tower_1_shadow:
        position: [15, 0]
        tower_style: {opacity: 0.2}
        misc:
          hide_tower_name: true
          swap_channel: '12'
      tower_2:
        position: [300, 0]
        misc:
          tower_name_style: { left: 25 }
          swap_channel: '01'
          draggable: all
          # block_offset: [ [25, 25], null ]
      tower_2_shadow:
        position: [300, 0]
        tower_style: {opacity: 0.2}
        misc:
          hide_tower_name: true
          swap_channel: '01'
      tower_result:
        position: [550, 0]
        misc:
          tower_name_style: { left: 25 }
          toggle: mean_name_toggle  # created by the partition
    event_handling:
      arg_1: tower_1
      arg_2: tower_2
      result: tower_result
      drag_blocks_to_result: true
      correctness: all_moved
      touch_reveals_button: [submit]
      # no_split_fiver: true
      # minimum_split_size: -1
    misc:
      new_scale_factor: 200
      config_iteration: 4
      num_stars: 2
      remove_on_exit: [button_submit]
  missing_addend:
    level_1:
      params:
        misc:
          config_iteration: 2
    level_2:
      params:
        create:
          tower_result: { name: nice_name }
          tower_4: { name: mean_name }
          tower_moving: []
        modify:
          tower_4:
            position: [550, 0]
            style: {opacity: 0}
          tower_moving:
            position: [0, 0]
            width: 50vw
            overflow: 'hidden'
            misc:
              hide_tower_name: true
        event_handling:
          drag_blocks_to_result: null
          swipe_tower: true
          target: tower_result
          moving: tower_moving
          # no_split_fiver: true
          minimum_split_size: -1
          comparison_source: tower_4
          correctness: identical
          expand_into_units: true
          show_blocks_moving_to_result: true
        misc:
          config_iteration: 3
      level_2a:
        params_from: [simple_mean_name_snippet]
      level_2b:
    level_3:
      params:
        create:
          tower_result: { name: nice_name }
          tower_moving: []
          tower_2: []
          tower_2_shadow: []
          tower_4: { name: m2 }
        modify:
          tower_moving:
            position: [0, 0]
            width: 50vw
            overflow: 'hidden'
            misc:
              hide_tower_name: true
          tower_4:
            position: [550, 0]
            style: {opacity: 0}
        event_handling:
          drag_blocks_to_result: null
          swipe_tower: true
          target: tower_result
          moving: tower_moving
          minimum_split_size: -1
          correctness: subset
          show_blocks_moving_to_result: true
        misc:
          config_iteration: null
          problem_stage: true
          skip_submit: true
          skip_in_between: true
      simpler_case:
        params_from: [simple_mean_name_snippet]
        stage_1:
        stage_2:
          params_from: [stage_2_building_arg_2_snippet]
          params:
            misc:
              goto_config: [3, [drag_blocks, missing_addend, level_3, simpler_case, stage_1]]
      harder_case:
        stage_1:
        stage_2:
          params_from: [stage_2_building_arg_2_snippet]
          params:
            misc:
              goto_config: [3, [drag_blocks, missing_addend, level_3, harder_case, stage_1]]
      level_3b:
        params:
          event_handling:
            show_blocks_moving_to_result: false
        simpler_case:
          params_from: [simple_mean_name_snippet]
          stage_1:
          stage_2:
            params_from: [stage_2_building_arg_2_snippet]
            params:
              misc:
                goto_config: [3, [drag_blocks, missing_addend, level_3, level_3b, simpler_case, stage_1]]
        harder_case:
          stage_1:
          stage_2:
            params_from: [stage_2_building_arg_2_snippet]
            params:
              misc:
                goto_config: [3, [drag_blocks, missing_addend, level_3, level_3b, harder_case, stage_1]]
counting_up_sub:
  params:
    generate: # { tower_1_name: [pick_from_range, .1, 3.8, .1] }
      mean_name_base_5: [pick_from_list, [[.5,.5, .5,.5, .5,.5], [1, .5,.5, .5,.5], [2, .5,.5], [.5,.5, .5,.5], [1, .5,.5], [.5,.5]]]
      # mean_name_base_5: [pick_from_list, [[1, .5,.5]]]
      extra_fiver: [pick_from_list, [0, .5]]
      extra_delta: [pick_from_range, 0, .45, .1]
      mean_name_f: mean_name_base_5 ++ extra_fiver
      mean_name: mean_name_f ++ extra_delta
      partition_1: mean_name into m1 and m2
      # mean_name: [fixed, [2, .5, .5, .5, .4]]
      # tower_1_name: mean_name
    create:
      big_paren: true
      big_op: +
      tower_2_shadow: { name: m2 }
      tower_1_shadow: { name: m1 }
      tower_mixed: []
      tower_2: { name: m2 }
      tower_1: { name: m1 }
      tower_result: []
    modify:
      big_paren:
        position: [20, 0]
        style: { width: 500 }
      big_op:
        position: [195, 0]
      tower_1:
        position: [15, 0]
        misc:
          swap_channel: '12'
      tower_1_shadow:
        position: [15, 0]
        tower_style: {opacity: 0.2}
        misc:
          hide_tower_name: true
          swap_channel: '12'
      tower_2:
        position: [300, 0]
        misc:
          swap_channel: '01'
      tower_2_shadow:
        position: [300, 0]
        tower_style: {opacity: 0.2}
        misc:
          hide_tower_name: true
          swap_channel: '01'
      tower_mixed:
        position: [510, 0]
        tower_style: {opacity: 0}
        misc:
          hide_tower_name: true
      tower_result:
        position: [right 10vw, 0]
        tower_style: {opacity: 0}
        misc:
          tower_name_style: { left: 25 }
    event_handling:
      correctness: identical
      touch_reveals_button: [submit, delete]
      counting_up_sub: true
    misc:
      new_scale_factor: 200
      num_stars: 2
      remove_on_exit: [button_submit, button_delete]
      config_iteration: 4
      trigger_blocks_moving_to_result: 500
  missing_addend:
    params_from: [tower_missing_addend_direct_snippet]
    params:
      generate:
        extra_delta: [fixed, 0]
      event_handling:
        allow_non_standard: null
    level_1:
      params:
        create:
          # tower_1: [.5]
          # tower_2: []
        event_handling:
          # show_mean_result_at_end: true
          # show_blocks_moving_to_result: true
  missing_addend_2:
    params_from: [tower_missing_addend_direct_snippet]
    params:
      event_handling:
        allow_non_standard: null
    level_1:
  singletons:
    params:
      generate:
        mean_name_base_1: [pick_from_list, [[.3,.3], [.4,.2], [.2,.4], [.4,.3], [.3,.4], [.4,.4]]]
        # mean_name_base_1: [pick_from_list, [[.3,.4]]]
        extra_box: [pick_from_range, 0, 2.1, 1]
        mean_name: extra_box ++ mean_name_base_1
      event_handling:
        expand_into_units: true  # to allow .3, .4 == .4, .3
    missing_addend:
      params_from: [tower_missing_addend_direct_snippet]
      params:
        event_handling:
          allow_non_standard: null
      level_1:
  singletons_separate_fivers:
    params:
      generate:
        mean_name_base_1: [pick_from_list, [[.3,.3], [.4,.2], [.2,.4], [.4,.3], [.3,.4], [.4,.4]]]
        mean_name_base_5: [pick_from_list, [[.5,.5, .5,.5, .5,.5], [1, .5,.5, .5,.5], [2, .5,.5], [.5,.5, .5,.5], [1, .5,.5], [.5,.5]]]
        mean_name: mean_name_base_5 ++ mean_name_base_1
      event_handling:
        expand_into_units: true  # to allow .3, .4 == .4, .3
    missing_addend:
      params_from: [tower_missing_addend_direct_snippet]
      params:
        event_handling:
          allow_non_standard: null
      level_1:
  singletons_with_a_fiver:
    params:
      generate:
        mean_name_base_1: [pick_from_list, [[.3,.3], [.4,.2], [.2,.4], [.4,.3], [.3,.4], [.4,.4]]]
        extra_box: [pick_from_range, 0, 2.1, 1]
        extra_fiver: [fixed, 0.5]
        mean_name_f: extra_box ++ extra_fiver
        mean_name: mean_name_f ++ mean_name_base_1
      event_handling:
        expand_into_units: true  # to allow .3, .4 == .4, .3
    missing_addend:
      params_from: [tower_missing_addend_direct_snippet]
      params:
        event_handling:
          allow_non_standard: null
      level_1:
  singletons_with_fivers:
    params:
      generate:
        mean_name_base_1: [pick_from_list, [[.1, .2], [.3, .1], [.3,.3], [.4,.2], [.2,.4], [.4,.3], [.3,.4], [.4,.4]]]
        mean_name_base_5: [pick_from_list, [[.5,.5, .5,.5, .5,.5], [1, .5,.5, .5,.5], [2, .5,.5], [.5,.5, .5,.5], [1, .5,.5], [.5,.5]]]
        extra_fiver: [pick_from_list, [0, .5, .5, .5, .5]]
        mean_name_f: mean_name_base_5 ++ extra_fiver
        mean_name: mean_name_f ++ mean_name_base_1
      event_handling:
        expand_into_units: true  # to allow .3, .4 == .4, .3
    missing_addend:
      params_from: [tower_missing_addend_direct_snippet]
      params:
        event_handling:
          allow_non_standard: null
      level_1:
tower_addition:
  params:
    generate: # { tower_1_name: [pick_from_range, .1, 3.8, .1] }
      mean_name_base_5: [pick_from_list, [[.5,.5, .5,.5, .5,.5], [1, .5,.5, .5,.5], [2, .5,.5], [.5,.5, .5,.5], [1, .5,.5], [.5,.5]]]
      # mean_name_base_5: [pick_from_list, [[1, .5,.5]]]
      extra_fiver: [pick_from_list, [0, .5]]
      extra_delta: [pick_from_range, 0, .45, .1]
      mean_name_f: mean_name_base_5 ++ extra_fiver
      mean_name: mean_name_f ++ extra_delta
      partition_1: mean_name into m1 and m2
      # mean_name: [fixed, [2, .5, .5, .5, .4]]
      # tower_1_name: mean_name
    create:
      big_paren: true
      big_op: +
      tower_2_shadow: { name: m2 }
      tower_1_shadow: { name: m1 }
      tower_result: []
      tower_2: { name: m2 }
      tower_1: { name: m1 }
    modify:
      big_paren:
        position: [20, 0]
        style: { width: 500 }
      big_op:
        position: [195, 0]
      tower_1:
        position: [15, 0]
        misc:
          swap_channel: '12'
      tower_1_shadow:
        position: [15, 0]
        tower_style: {opacity: 0.2}
        misc:
          hide_tower_name: true
          swap_channel: '12'
      tower_2:
        position: [300, 0]
        misc:
          swap_channel: '01'
      tower_2_shadow:
        position: [300, 0]
        tower_style: {opacity: 0.2}
        misc:
          hide_tower_name: true
          swap_channel: '01'
      tower_result:
        position: [right 10vw, 0]
        tower_style: {opacity: 0}
        misc:
          tower_name_style: { left: 25 }
    event_handling:
      correctness: identical
      touch_reveals_button: [submit, delete]
      no_split_fiver: true
      minimum_split_size: -1
    misc:
      new_scale_factor: 200
      num_stars: 2
      remove_on_exit: [button_submit, button_delete]
      config_iteration: 4
  direct:
    skip_node_above:
    params_from: [tower_addition_direct_snippet]
    level_1:
    level_2:
      params:
        modify:
          tower_1:
            anim_info:
              delay: 500
              tower_opacity: [1, 0]
              duration: 1000
          tower_2:
            anim_info:
              tower_opacity: [1, 0]
              delay: 500
              duration: 1000
    level_3:
      skip_node_above:
      params:
        modify:
          tower_1:
            tower_style: {opacity: 0}
          tower_2:
            tower_style: {opacity: 0}
  missing_addend:
    params_from: [tower_missing_addend_direct_snippet]
    params:
      generate:
        extra_delta: [fixed, 0]
    level_1:
      params:
        event_handling:
          # show_mean_result_at_end: true
          # show_blocks_moving_to_result: true
    level_2:
      params_from: [fade_tower_1_snippet]
    level_3:
      params_from: [fade_tower_1_and_result_snippet]
  missing_addend_2:
    params_from: [tower_missing_addend_direct_snippet]
    level_1:
    level_2:
      params_from: [fade_tower_1_snippet]
    level_3:
      params_from: [fade_tower_1_and_result_snippet]
      # jmp: [tower_addition, singletons, missing_addend, level_1]
  singletons:
    params:
      generate:
        mean_name_base_1: [pick_from_list, [[.3,.3], [.4,.2], [.2,.4], [.4,.3], [.3,.4], [.4,.4]]]
        # mean_name_base_1: [pick_from_list, [[.3,.4]]]
        extra_box: [pick_from_range, 0, 2.1, 1]
        mean_name: extra_box ++ mean_name_base_1
      event_handling:
        expand_into_units: true  # to allow .3, .4 == .4, .3
    direct:
      skip_node_above:
      params_from: [tower_addition_direct_snippet]
      params:
        misc:
          config_iteration: 7
          num_stars: 3
      level_1:
        params:
      level_2:
        params:
          modify:
            tower_1:
              anim_info:
                tower_opacity: [1, 0]
                delay: 500
                duration: 1000
            tower_2:
              anim_info:
                tower_opacity: [1, 0]
                delay: 500
                duration: 1000
      level_3:
        skip_node_above:
        params:
          modify:
            tower_1:
              tower_style: {opacity: 0}
            tower_2:
              tower_style: {opacity: 0}
    missing_addend:
      params_from: [tower_missing_addend_direct_snippet]
      level_1:
      level_2:
        params_from: [fade_tower_1_snippet]
      level_3:
        params_from: [fade_tower_1_and_result_snippet]
        # jmp: [tower_addition, singletons_separate_fivers, missing_addend, level_1]
  singletons_separate_fivers:
    params:
      generate:
        mean_name_base_1: [pick_from_list, [[.3,.3], [.4,.2], [.2,.4], [.4,.3], [.3,.4], [.4,.4]]]
        mean_name_base_5: [pick_from_list, [[.5,.5, .5,.5, .5,.5], [1, .5,.5, .5,.5], [2, .5,.5], [.5,.5, .5,.5], [1, .5,.5], [.5,.5]]]
        mean_name: mean_name_base_5 ++ mean_name_base_1
      event_handling:
        expand_into_units: true  # to allow .3, .4 == .4, .3
    direct:
      skip_node_above:
      params_from: [tower_addition_direct_snippet]
      level_1:
        params:
      level_2:
        params:
          modify:
            tower_1:
              anim_info:
                tower_opacity: [1, 0]
                delay: 500
                duration: 1000
            tower_2:
              anim_info:
                tower_opacity: [1, 0]
                delay: 500
                duration: 1000
      level_3:
        skip_node_above:
        params:
          modify:
            tower_1:
              tower_style: {opacity: 0}
            tower_2:
              tower_style: {opacity: 0}
    missing_addend:
      params_from: [tower_missing_addend_direct_snippet]
      level_1:
      level_2:
        params_from: [fade_tower_1_snippet]
      level_3:
        params_from: [fade_tower_1_and_result_snippet]
        # jmp: [tower_addition, singletons_with_a_fiver, missing_addend, level_1]
  singletons_with_a_fiver:
    params:
      generate:
        mean_name_base_1: [pick_from_list, [[.3,.3], [.4,.2], [.2,.4], [.4,.3], [.3,.4], [.4,.4]]]
        extra_box: [pick_from_range, 0, 2.1, 1]
        extra_fiver: [fixed, 0.5]
        mean_name_f: extra_box ++ extra_fiver
        mean_name: mean_name_f ++ mean_name_base_1
      event_handling:
        expand_into_units: true  # to allow .3, .4 == .4, .3
    direct:
      skip_node_above:
      params_from: [tower_addition_direct_snippet]
      level_1:
        params:
      level_2:
        params:
          modify:
            tower_1:
              anim_info:
                tower_opacity: [1, 0]
                delay: 500
                duration: 1000
            tower_2:
              anim_info:
                tower_opacity: [1, 0]
                delay: 500
                duration: 1000
      level_3:
        skip_node_above:
        params:
          modify:
            tower_1:
              tower_style: {opacity: 0}
            tower_2:
              tower_style: {opacity: 0}
    missing_addend:
      params_from: [tower_missing_addend_direct_snippet]
      level_1:
      level_2:
        params_from: [fade_tower_1_snippet]
      level_3:
        params_from: [fade_tower_1_and_result_snippet]
        # jmp: [tower_addition, singletons_with_fivers, missing_addend, level_1]
  singletons_with_fivers:
    params:
      generate:
        mean_name_base_1: [pick_from_list, [[.1, .2], [.3, .1], [.3,.3], [.4,.2], [.2,.4], [.4,.3], [.3,.4], [.4,.4]]]
        mean_name_base_5: [pick_from_list, [[.5,.5, .5,.5, .5,.5], [1, .5,.5, .5,.5], [2, .5,.5], [.5,.5, .5,.5], [1, .5,.5], [.5,.5]]]
        extra_fiver: [pick_from_list, [0, .5, .5, .5, .5]]
        mean_name_f: mean_name_base_5 ++ extra_fiver
        mean_name: mean_name_f ++ mean_name_base_1
      event_handling:
        expand_into_units: true  # to allow .3, .4 == .4, .3
    direct:
      skip_node_above:
      params_from: [tower_addition_direct_snippet]
      level_1:
        params:
      level_2:
        params:
          modify:
            tower_1:
              anim_info:
                tower_opacity: [1, 0]
                delay: 500
                duration: 1000
            tower_2:
              anim_info:
                tower_opacity: [1, 0]
                delay: 500
                duration: 1000
      level_3:
        skip_node_above:
        params:
          modify:
            tower_1:
              tower_style: {opacity: 0}
            tower_2:
              tower_style: {opacity: 0}
    missing_addend:
      params_from: [tower_missing_addend_direct_snippet]
      level_1:
      level_2:
        params_from: [fade_tower_1_snippet]
      level_3:
        params_from: [fade_tower_1_and_result_snippet]
        # jmp: [all_done]
# bar_addition:
# - params:
#   - generator: {random1: uniform, random2: uniform, sum_in_range: [.1,1]}
#   - event_handling: {down: jump_if_far, move: by_delta, submit: error_animation }
#   - misc: {num_exercises: 4}
#   - create:
#     - expr1:
#       - params: {op: +, left: 35}
#       - bar1: {value: random1}
#       - bar2: {value: random2}
#       - door1:
#         - params: {-locked, +knob_hidden, +is_target}
#     - button_submit: []
#   - modify: []
# - replicate_close_tile_height:
#   - params: {}
# - replicate_far_tile_height: []
# - replicate_far_tile_height:
#   - params: {maxNumExercises: 3}
#   - ex1:
#     - params: {+size11x17, +justStandardize}
#   - ex2:
#     - params: {+size8p5x11, +rebuildTower, +removeBorders}
# choose_tower_name:
# pack_unpack:
# standardize:
# estimate_sums:
# single_size_addition:
# multi_size_addition_1:
# multi_size_addition_2:
# decimal_frame:
# decimal_number:
# suuji_multiplication:
# estimating_products:
# multi_digit_addition:
# multi_digit_subtraction:
# shrinking_a_tower:
# multi_size_multiplication:
# decimal_to_shrink:
# multi_digit_multiplication:
all_done:
  params:
    create:
      center_text:  That's all for today!
reload_message:
  params:
    create:
      center_text:  Reloading...
suffix1:
  params:
    modify:
      door_1:
        misc: {tickmarks: null}
in_between:
  params:
    create:
      button_next:
stage_2_building_arg_2_snippet:
  params:
    create:
      keypad_kind: 'buildTower'
    event_handling:
      swipe_tower: false
      correctness: same_height
      comparison_source: tower_4
      show_blocks_moving_to_result: true
      target: tower_2
      touch_reveals_button: [submit, delete]
      allow_non_standard: true
    misc:
      problem_stage: false
      skip_submit: false
      skip_in_between: false
      remove_on_exit: [button_submit, button_delete]
simple_mean_name_snippet:
  params:
    generate:
      mean_name_base_5: [pick_from_list, [[.5,.5, .5,.5, .5,.5], [1, .5,.5, .5,.5], [2, .5,.5], [.5,.5, .5,.5], [1, .5,.5], [.5,.5]]]
      extra_fiver: [pick_from_list, [0, .5]]
      # extra_delta: [pick_from_range, 0, .45, .1]
      extra_delta: [fixed, 0]
      mean_name_f: mean_name_base_5 ++ extra_fiver
      mean_name: mean_name_f ++ extra_delta
      nice_name: standardize_name mean_name
tower_2_disappearing_snippet:
  params:
    modify:
      tower_2:
        tower_style:
          opacity: 1
        anim_info:
          tower_opacity: [1, 0]
          delay: 500
          duration: 1000
tower_2_disappeared_snippet:
  params:
    modify:
      tower_2:
        tower_style:
          opacity: 0
grouping_snippet_stage_1:
    params:
      event_handling:
        create_tower_by_height: true
        comparison_source: tower_1
        target: tower_mid
        allow_non_standard: true
grouping_snippet_stage_1_un:
  params_from: [grouping_snippet_stage_1]
  params:
    event_handling:
      allow_non_standard: null
grouping_snippet_stage_2:
    params:
      # generate:
      #   tower_mid_name: [fixed, [.5, .5, .5, .2]]
      # create:
      #   tower_mid: {name: tower_mid_name}
      event_handling:
        target: tower_mid
        moving: tower_moving
        correctness: is_standardized
        swipe_tower: true
        touch_reveals_button: [submit]
grouping_snippet_stage_2_un:
  params_from: [grouping_snippet_stage_2]
  params:
    modify:
      tower_4:
        style: {opacity: 1}
    event_handling:
      comparison_source: tower_4
      correctness: identical
grouping_snippet_stage_2_un_plus:
  params_from: [grouping_snippet_stage_2_un]
  params:
    misc:
      config_iteration: 7
      num_stars: 3
grouping_snippet_stage_3:
    params:
      create:
        keypad_kind: 'buildTower'
      event_handling:
        comparison_source: tower_mid
        target: tower_2
        allow_non_standard: true
      misc:
        # skip_submit: null
        skip_in_between: null
        problem_stage: null
        remove_on_exit: [button_submit, button_delete]
grouping_snippet_stage_3_un:
  params_from: [grouping_snippet_stage_3]
  params:
    event_handling:
      comparison_source: tower_4
grouping_direct_snippet:
    params:
      generate:
        nice_name: standardize_name mean_name
      create:
        keypad_kind: 'buildTower'
        tower_mid: { name: tower_1_name }
        tower_4: nice_name
      modify:
        tower_4:
          position: [0, 0]
          style: {opacity: 0}
      event_handling:
        target: tower_2
        allow_non_standard: true
        comparison_source: tower_4
      misc:
        remove_on_exit: [button_submit, button_delete]
        config_iteration: 4
        num_stars: 2
        problem_stage: null
        skip_in_between: null
grouping_direct_snippet_un:
  params_from: [grouping_direct_snippet]
  params:
    create:
      tower_4: mean_name
    modify:
      tower_4:
        position: [20vw, 400]
        # position: [0, 5]
        style: {opacity: 1}
    event_handling:
      comparison_source: tower_4
tower_addition_direct_snippet:
    params:
      generate:
        nice_name: standardize_name mean_name
      create:
        keypad_kind: 'buildTower'
        # tower_2: { name: tower_1_name }
        tower_4: nice_name
      modify:
        tower_4:
          position: [0, 0]
          style: {opacity: 0}
      event_handling:
        target: tower_result
        allow_non_standard: true
        comparison_source: tower_4
      misc:
        remove_on_exit: [button_submit, button_delete]
        config_iteration: 4
        num_stars: 2
        problem_stage: null
        skip_in_between: null
tower_missing_addend_direct_snippet:
  params_from: [tower_addition_direct_snippet]
  params:
    create:
      tower_2: []
      tower_2_shadow: []
      tower_4: m2
      tower_result: { name: nice_name }
      tower_mean: { name: mean_name }
    modify:
      tower_1:
        misc:
          tower_name_style: { left: 25 }
      tower_2:
        misc:
          tower_name_style: { left: 25 }
      tower_4:
        position: [300, 0]
        style: {opacity: 0}
      tower_result:
        position: [550, 0]
        tower_style: {opacity: 1}
      tower_mean:
        position: [550, 0]
        style: {opacity: 0}
    event_handling:
      comparison_source: tower_4
      target: tower_2
      correctness: same_height
fade_tower_1_snippet:
  params:
    modify:
      tower_1:
        anim_info:
          tower_opacity: [1, 0]
          delay: 500
          duration: 1000
      tower_1_shadow:
        tower_style: {opacity: 0}
      tower_2:
        tower_style: {opacity: 0}
      tower_2_shadow:
        tower_style: {opacity: 0}
fade_tower_1_and_result_snippet:
  params:
    modify:
      tower_1:
        tower_style: {opacity: 0}
      tower_1_shadow:
        tower_style: {opacity: 0}
      tower_2:
        tower_style: {opacity: 0}
      tower_2_shadow:
        tower_style: {opacity: 0}
      tower_result:
        anim_info:
          tower_opacity: [1, 0]
          delay: 500
          duration: 1000
return_bar_2:  # this is not a level;  it is an animation snippet
  params:
    modify:
      bar_2:
        anim_info:
          # left: [bar_1_x, 195]
          bottom: [bar_1_y, 0]
          delay: 1000
          duration: 500
          on_end: [reveal_bar_3]
reveal_bar_3:  # this is not a level;  it is an animation snippet
  params:
    modify:
      bar_3:
        # style: {opacity: 1}
        anim_info:
          opacity: [0, 1]
          delay: 500
          duration: 500
rotate45:  # this is not a level;  it is an animation snippet
  params:
    modify:
      tile_1:
        anim_info:
          rotate: [0deg, -45deg]
          duration: 1000
make_green:  # this is not a level;  it is an animation snippet
  params:
    modify:
      tile_1:
        style: {backgroundColor: green}
        anim_info:
          opacity: [1, .5]
          duration: 1000
          on_end: [rotate45]
animation_test:
  params:
    create:
      tile_1: kitty
    modify:
      tile_1:
        position: [10, 0]
        style:
          transformOrigin: bottom left
        anim_info:
          # left: [10, 400]
          scale: [1, 0.5]
          delay: 500
          duration: [500, 500, 500]
          # on_end: [make_green]
    event_handling:
      just_yaml_event: true
      on_down:
        modify:
          tile_1:
            anim_info:
              bottom: [0, 100]
              duration: 500
      on_up:
        modify:
          tile_1:
            anim_info:
              bottom: [100, 0]
              duration: 500

tangrams:
  params:
    misc:
      is_game: true
